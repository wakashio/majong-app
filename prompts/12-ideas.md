# アイデア

## 記録ルール

- 日付順（新しいものから上）に記録
- 各エントリにステータスを付与: `[議論待ち]` / `[議論中]` / `[議論完了]` / `[却下]`
- 議論完了後は議事録（`11-meeting-notes.md`）に移行
- 議事録への参照を記載（議論完了時）

## テンプレート

```markdown
## YYYY-MM-DD アイデア名

### [議論待ち] タイトル

- **内容**: アイデアの詳細説明
- **提案者**: 提案者の名前
- **優先度**: 高/中/低
- **関連機能**: 関連する既存機能（オプション）
- **備考**: その他の情報（オプション）
```

---

## ステータス説明

- `[議論待ち]`: まだ議論されていないアイデア
- `[議論中]`: 現在議論中のアイデア
- `[議論完了]`: 議論が完了し、議事録に移行済み
- `[却下]`: 議論の結果、却下されたアイデア

## 記録例

### [議論完了] ダークモード対応

- **内容**: UI にダークモードを追加し、ユーザーが切り替え可能にする
- **提案者**: ユーザー要望
- **優先度**: 中
- **関連機能**: UI/UX
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2024-01-25 デザイン検討会議)

### [議論待ち] 問題の難易度設定機能

- **内容**: 問題に難易度（初級/中級/上級）を設定し、フィルタリング可能にする
- **提案者**: 開発チーム
- **優先度**: 低
- **関連機能**: 問題表示、フィルタリング

---

## アイデア一覧

### 2026-01-03 ロンの時の点数のマイナスが計算されなくなってしまった

### [議論完了] ロンの時の点数のマイナスが計算されなくなってしまった

- **内容**: ロンの時の点数のマイナスが計算されなくなってしまった。バックエンドでの計算を削除し、フロントエンドから送信された点数をそのまま使用するように変更した際に、ロン時の放銃者のマイナス点数、本場、積み棒が正しく計算されなくなった。ロン時は、和了者が点数を受け取り、放銃者がマイナス点数を支払う必要があるが、現在の実装では放銃者のマイナス点数、本場、積み棒が正しく計算されていない。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: 点数計算、ロン、放銃者、本場、積み棒、`ResultInputDialog.vue`、`roundService.ts`、`scoreCalculationService.ts`
- **備考**: ツモ時は点数表を使って計算するように変更したが、ロン時は点数表を使わず、フロントエンドから送信された点数をそのまま使用するように変更した。しかし、ロン時は和了者が点数を受け取り、放銃者がマイナス点数を支払う必要があるため、フロントエンドで正しく計算して送信する必要がある。現在の実装では、ロン時の放銃者のマイナス点数、本場、積み棒が正しく計算されていない。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-03 ロン時の点数計算の修正（本場・積み棒・放銃者の点数計算）)

### 2026-01-02 ステージング環境の500エラー問題: Cloud RunからCloud SQLへの接続エラーを解決する

### [議論完了] ステージング環境の500エラー問題: Cloud RunからCloud SQLへの接続エラーを解決する

- **内容**: ステージング環境でフロントエンドからAPIを実行すると500エラーが発生している。ログを確認した結果、Cloud RunからCloud SQL（プライベートIP `10.103.0.3`）への接続がタイムアウトしている（レイテンシー127秒や0.6-0.8秒）。原因は、Cloud SQLがプライベートIPのみで設定されているが、Cloud RunにVPCコネクタが設定されていないため、プライベートIP接続ができないことである。解決方法として、以下の2つの選択肢がある: (1) Cloud SQL Proxyを使用する方法（推奨・簡単）: `--add-cloudsql-instances`フラグを使用してCloud SQL Proxy経由で接続する。接続文字列は`/cloudsql/CONNECTION_NAME`形式または`localhost`形式を使用する。(2) VPCコネクタを設定する方法（複雑）: VPCコネクタを作成し、Cloud Runサービスに設定する。プライベートIPで直接接続する。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: インフラ設定、Cloud Run、Cloud SQL、データベース接続、デプロイ設定、`.github/workflows/deploy.yml`、`.github/workflows/deploy-production.yml`、`backend/src/utils/prisma.ts`、`backend/src/middleware/errorHandler.ts`
- **備考**: 現在の設定では、Cloud SQLはプライベートIPのみ（`ipv4_enabled = false`）で設定されており、DATABASE_URLは`postgresql://majong_user:****@10.103.0.3:5432/majong_db`形式となっている。エラーログでは、`/api/sessions`と`/api/hanchans`で500エラーが発生し、レスポンスサイズが295バイト（エラーレスポンス）となっている。エラーハンドリングミドルウェアとPrismaクライアントのログ改善は既に実装済み。Cloud SQL Proxyを使用する場合、接続名（`PROJECT_ID:REGION:INSTANCE_NAME`形式）を取得し、`--add-cloudsql-instances`フラグで指定する必要がある。接続文字列は`postgresql://user:password@/database?host=/cloudsql/CONNECTION_NAME`形式に変更する。VPCコネクタを使用する場合、VPCコネクタの作成とCloud Runサービスへの設定が必要。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-02 ステージング環境の500エラー問題: Cloud RunからCloud SQLへの接続エラーを解決する)

### 2026-01-02 e2eテストがすべてエラーになっている件に対応する

### [議論待ち] e2eテストがすべてエラーになっている件に対応する

- **内容**: e2eテストがすべてエラーになっている問題に対応する。現在、Playwrightのブラウザ（chromium、firefox、webkit）がインストールされていないため、すべてのe2eテストが失敗している。エラーメッセージには「npx playwright install」を実行するように指示されている。ブラウザをインストールすることで、e2eテストが正常に実行できるようになる。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: e2eテスト、Playwright、テスト環境、`frontend/e2e/vue.spec.ts`、`playwright.config.ts`
- **備考**: 現在、45個のテストがすべて失敗しており、エラーメッセージは「Executable doesn't exist at C:\Users\wakai\AppData\Local\ms-playwright\chromium-1200\chrome-win64\chrome.exe」などとなっている。`npx playwright install`コマンドを実行してブラウザをインストールする必要がある。また、CI/CD環境でも同様の問題が発生しないように、`package.json`のセットアップスクリプトにブラウザインストールコマンドを含めることを検討する。
- **対応状況**: Playwrightブラウザのインストールは完了。最初のテスト（`visits the app root url`）のセレクタエラーを修正（`page.getByText('麻雀記録アプリ')`を使用）。残りのテストは、バックエンドサーバーの起動やテストデータの準備が必要なため、別途対応が必要。

### 2026-01-02 Teratermを使ったGCPへのデプロイ設定を行いたい。そのためにまず、インフラの設計を行いたい。

### [議論完了] Teratermを使ったGCPへのデプロイ設定を行いたい。そのためにまず、インフラの設計を行いたい。

- **内容**: Teratermを使ったGCPへのデプロイ設定を行いたい。そのためにまず、インフラの設計を行いたい。GCP上にアプリケーションをデプロイするためのインフラストラクチャを設計し、Terraformを使用したインフラのコード化とデプロイ方法を確立する。インフラ設計では、GCPの各種サービス（Cloud Run、Cloud SQL、Cloud Storage、Cloud Buildなど）の選定と構成、ネットワーク設計、セキュリティ設定、監視・ログ設定などを検討する。デプロイ方法としては、Terraformによるインフラのコード化と、GitHub ActionsなどのCI/CDパイプラインとの組み合わせを検討する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: インフラ設計、デプロイ設定、GCP、CI/CD、Terraform、インフラストラクチャ、クラウド環境
- **備考**: 現在のプロジェクトはローカル環境（Docker Compose）で動作しているが、本番環境としてGCPへの移行を検討する。インフラ設計では、バックエンド（Node.js/Express）、フロントエンド（Vue.js）、データベース（PostgreSQL）の配置方法、スケーラビリティ、可用性、コスト最適化などを考慮する必要がある。Terraformを使用したインフラのコード化により、インフラの管理を容易にする。既存のアイデア「git管理とCI/CDについて」（2026-01-01）と関連がある。
- **議論内容**: ユーザー要件を確認（想定ユーザー数: 5人程度、同時使用最大5人、コスト予算: ほぼ0円想定、可用性目標: オンデマンド利用、環境分離: ステージング/本番、既存のGCPプロジェクト: なし、GCPへのこだわり: なし）。GCPの無料枠とコスト見積もりを提示（月額¥1,000-1,500程度、データベースのみ有料）。GCPを選択することを決定。インフラ設計方針: (1) フロントエンド: Cloud Run（無料枠内）、(2) バックエンド: Cloud Run（無料枠内）、(3) データベース: Cloud SQL for PostgreSQL（最小構成: db-f1-micro、月額約¥1,000-1,500）、(4) ストレージ: Cloud Storage（無料枠内）、(5) インフラコード化: Terraformを使用、(6) デプロイ: GitHub Actionsと組み合わせたCI/CDパイプライン、(7) 環境分離: ステージング環境と本番環境を分離。リージョンは無料枠が適用されるus-west1、us-central1、us-east1から選択。コスト最適化のため、最小構成のデータベースを使用し、無料枠を最大限活用する方針で決定。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-02 GCPインフラ設計)

### 2026-01-02 合計点数は30000返しの時は30000点引いて1000で割った値の合計が表示されていて欲しい

### [議論完了] 合計点数は30000返しの時は30000点引いて1000で割った値の合計が表示されていて欲しい

- **内容**: 統計情報の合計点数表示について、各半荘の返し点数（`Session.umaOkaConfig.returnScore`）を使って、各プレイヤーの`finalScoreWithUmaOka`から返し点数を引いて1000で割った値（プラスマイナス何点かを1000点単位で表示）の合計を表示したい。現在の実装では、合計点数がそのまま表示されているが、各半荘の返し点数を使って変換計算（例: 返し点数30000の場合、35000点 → (35000 - 30000) / 1000 = 5点）を行い、その合計を表示することで、より分かりやすい表示になる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 統計情報、合計点数表示、ウマオカ計算、参加者統計、セッション統計、`statisticsService.ts`、`getPlayerStatistics`関数、`sessionService.ts`、`getStatistics`関数、`GET /api/players/:id/statistics` API、`GET /api/sessions/:id/statistics` API
- **備考**: 各半荘の`Session.umaOkaConfig.returnScore`を取得し、各半荘ごとに`(finalScoreWithUmaOka - returnScore) / 1000`を計算して合計する。例: 半荘1（30000返し）でプレイヤーAが35000点 → (35000-30000)/1000=5点、半荘2（25000返し）でプレイヤーAが28000点 → (28000-25000)/1000=3点、合計は5+3=8点となる。この計算方法により、返し点数を基準とした合計点数が表示できる。
- **議論内容**: 各半荘の返し点数（`Session.umaOkaConfig.returnScore`）を使って変換計算を行う方針で決定。30000返しに固定せず、各半荘の実際の返し点数を使用する。計算式: `(finalScoreWithUmaOka - returnScore) / 1000`。対象API: `GET /api/players/:id/statistics`、`GET /api/sessions/:id/statistics`。実装箇所: `statisticsService.ts`の`getPlayerStatistics`関数、`sessionService.ts`の`getStatistics`関数。フロントエンドでは「合計点数（返し点換算）」などと表示し、単位は「点」（1000点単位）で表示する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-02 統計情報の合計点数表示の改善（返し点換算）)

### 2026-01-02 最新の局までスクロールするボタンがいつでもアクセス可能な位置に欲しい

### [議論完了] 最新の局までスクロールするボタンがいつでもアクセス可能な位置に欲しい

- **内容**: 局管理画面で最新の局までスクロールするボタンを、いつでもアクセス可能な位置（例: 固定位置のフローティングボタン）に配置したい。局が多くなった場合、最新の局までスクロールするのが大変になるため、常に表示されるボタンがあると便利である。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、UI/UX、スクロール機能、`RoundManageView.vue`
- **備考**: 局が多くなった場合、最新の局までスクロールするのが大変になるため、常に表示されるボタン（フローティングアクションボタンなど）があると便利である。ボタンの配置位置としては、画面右下の固定位置や、局一覧の上部などが考えられる。
- **議論内容**: フローティングボタンを右上に配置する方針で決定。実装方針として、Vuetifyの`v-btn`を使用し、`fab`プロパティでフローティングボタンとして実装。スクロール先は局番号が最大の局（`sortedRounds`の最後の要素）とし、局が2つ以上ある場合のみ表示。ボタンのアイコンは`mdi-arrow-down`または`mdi-chevron-double-down`を使用し、ツールチップで「最新の局へスクロール」を表示。スクロール実装は`scrollIntoView()`を使用し、必要に応じて`expandedPanels`に該当局のIDを追加して展開する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-02 最新の局までスクロールするボタンの追加)

### 2026-01-02 ツモ・ロン時の点数入力方式の変更（計算方式からテーブル方式へ）

### [議論完了] ツモ・ロン時の点数入力方式の変更（計算方式からテーブル方式へ）

- **内容**: ツモ時の点数計算を計算するのではなく、点数ごとに親が支払う点数、子が支払う点数を保持するテーブル方式にする。点数を入力形式（v-text-field）ではなく、プルダウン（v-select）にする。ロンの時は点数表は不要（和了点 = 放銃者の支払い点数そのまま）。これにより、点数計算のロジックを簡素化し、UIの操作性を向上させる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 点数計算、ツモ処理、ロン処理、UI/UX、結果入力、点数入力、`useScoreCalculation.ts`、`scoreCalculationService.ts`、`roundService.ts`、`ResultInputDialog.vue`、`useResultInput.ts`
- **備考**: 現在の実装では、ツモ・ロン時に点数を手動で入力する形式になっているが、麻雀の点数は決まったパターンがあるため、テーブル方式で管理することで入力ミスを減らし、操作性を向上させることができる。点数テーブルはツモ時のみ必要で、親がツモした場合と子がツモした場合で異なるテーブルを使用する。ロン時は点数表不要で、和了点 = 放銃者の支払い点数そのまま。
- **議論内容**: 点数表の要件を確認。ロン時は点数表不要（和了点 = 放銃者の支払い点数そのまま）。点数表はツモ時のみ必要: (1) ツモ（親が和了）: 和了点 → 子1人あたりの支払い点数（本場・積み棒除く）、(2) ツモ（子が和了）: 和了点 → 親からの支払い点数、子からの支払い点数（本場・積み棒除く）。点数表の範囲: 1000点〜36000点（トリプル役満まで）。本場・積み棒は点数表に含めず、別途計算。バックエンドで点数表を保持し、計算もバックエンドで行う。フロントエンドでは点数をプルダウン（v-select）で選択し、選択した点数をバックエンドに送信して計算を行う。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-02 ツモ・ロン時の点数入力方式の変更（計算方式からテーブル方式へ）)

### 2026-01-02 親が聴牌で流局したときに親が変わってしまうことは不具合です

### [議論完了] 親が聴牌で流局したときに親が変わってしまうことは不具合です

- **内容**: 親が聴牌で流局したときに親が変わってしまうことは不具合です。麻雀のルールでは、親がテンパイで流局した場合は連荘となり、親は変わらないはずです。現在の実装では、`frontend/src/composables/useRoundNavigation.ts`の81行目で連荘の判定を`nextSettings.nextRoundNumber === round.roundNumber`（局番号が同じかどうか）で行っているが、親がテンパイで流局した場合でも局番号が変わってしまうと親が変わってしまう不具合が発生している可能性があります。連荘の判定は`calculateNextSettings` APIのレスポンスに含まれる`isRenchan`フラグを使用するか、または`isDealerRenchan`関数の結果を正しく反映する必要があります。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: 流局処理、親の判定、連荘判定、次局作成、`useRoundNavigation.ts`、`calculateNextSettings` API、`isDealerRenchan`関数、`roundController.ts`
- **備考**: 現在の実装では、`useRoundNavigation.ts`の81行目で局番号の比較で連荘を判定しているが、親がテンパイで流局した場合でも局番号が変わってしまうと親が変わってしまう不具合が発生している可能性があります。`calculateNextSettings` APIでは`isRenchan`を計算しているが、フロントエンドで正しく使用されていない可能性があります。修正方針: `calculateNextSettings` APIのレスポンスに`isRenchan`フラグを含めるか、またはフロントエンドで`isDealerTenpai`の情報を正しく使用して連荘を判定する必要があります。`backend/src/services/riichiHonbaCalculationService.ts`の`isDealerRenchan`関数は正しく実装されているが、フロントエンドでの連荘判定ロジックを修正する必要があります。
- **議論内容**: 現状の問題点を確認し、修正方針を決定。`CalculateNextSettingsResponse`に`isRenchan`フラグを追加し、フロントエンドで`isDealerTenpai`を正しく取得してAPIに渡す方針で決定。連荘判定ロジックを局番号の比較から`isRenchan`フラグの使用に変更する方針で決定。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-02 親が聴牌で流局したときに親が変わってしまう不具合の修正)

### 2026-01-02 ツモ時の計算方法について、変な100点が考慮されている点を修正したい

### [議論待ち] ツモ時の計算方法について、変な100点が考慮されている点を修正したい

- **内容**: ツモ時の計算方法について、変な100点が考慮されている点を修正したい。正しい計算式は以下の通り: (1) 子がツモした場合: 基本点 = 和了点 / 4、親から = (基本点 × 2) + (本場 × 100)、子から = (基本点 × 1) + (本場 × 100)。(2) 親がツモした場合: 基本点 = 和了点 / 3、子から = (基本点 × 1) + (本場 × 100)。現在の実装では、ツモ時の本場計算が「本場 × 300」となっている箇所があるが、正しくは「本場 × 100」である。修正が必要な箇所: `backend/src/services/scoreCalculationService.ts`の`calculateTsumoScore`関数、`frontend/src/composables/useScoreCalculation.ts`の`calculateTsumoScore`関数、`backend/src/services/roundService.ts`の本場計算部分、設計書（`design/score-calculation-logic.md`）、テストコード。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: 点数計算、ツモ処理、打点計算、本場計算、`useScoreCalculation.ts`、`calculateTsumoScore`関数、`scoreCalculationService.ts`、`roundService.ts`
- **備考**: 現在の実装では、ツモ時の本場計算が「本場 × 300」となっているが、正しくは「本場 × 100」である。親がツモした場合、子1人あたりは (基本点 × 1) + (本場 × 100) であり、(基本点 × 2) + (本場 × 300) ではない。子がツモした場合、親からは (基本点 × 2) + (本場 × 100) であり、(基本点 × 2) + (本場 × 300) ではない。ロン時の本場計算（本場 × 300）は変更不要。

### 2026-01-02 局管理で半荘終了のUIを追加します

### [議論待ち] 局管理で半荘終了のUIを追加します

- **内容**: 局管理画面（`RoundManageView.vue`）に半荘終了のUIを追加する。現在、半荘終了処理は`HanchanInfoCard`コンポーネントから`@end-hanchan`イベントで呼び出されているが、より目立つ場所や使いやすい場所に半荘終了ボタンやUIを追加する。半荘終了の判定条件（局番号が16局に達した場合、または誰かが30000点を超えた場合など）に基づいて、適切なタイミングで半荘終了UIを表示する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、半荘管理、半荘終了処理、UI/UX、`RoundManageView.vue`、`HanchanInfoCard.vue`、`handleEndHanchan`関数、`openEndHanchanDialog`関数
- **備考**: 現在の実装では、`RoundManageView.vue`の413-465行目に半荘終了処理（`openEndHanchanDialog`、`handleEndHanchan`）が実装されており、`HanchanInfoCard`コンポーネントから呼び出されている。半荘終了のUIを追加することで、ユーザーが半荘終了をより簡単に実行できるようになる。半荘終了の判定条件を明確にし、適切なタイミングで半荘終了UIを表示する必要がある。既存のアイデア「局終了時の半荘終了判定と次の局への遷移」（2025-12-31）は却下されているが、今回はUI追加に焦点を当てている。

### 2026-01-01 ウマオカ計算ロジックの修正（1位にオカの合計を加算する）

### [議論完了] ウマオカ計算ロジックの修正（1位にオカの合計を加算する）

- **内容**: ウマオカ計算ロジックを修正する。現在の実装では全員に`oka`を加算した後、1位に`oka × 4`を加算していたが、計算が二重になっている可能性がある。正しくは全員から返し点（`returnScore`）を減算し、1位に20000を加算する方式に変更する。つまり、1位は`currentScore - returnScore + 20000 + uma`、2位以下は`currentScore - returnScore + uma`となる。`umaOkaCalculationService.ts`の`calculateUmaOka`関数を修正する。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: ウマオカ計算、半荘終了処理、`umaOkaCalculationService.ts`、`calculateUmaOka`関数、`hanchanService.ts`
- **備考**: 現在の実装では、全員に`oka`を加算した後、1位に`oka × 4`を加算していたが、計算が二重になっている可能性がある。デフォルト設定（25000持ち30000返し）では、全員から返し点（30000）を減算し、1位に20000を加算する方式に変更する。テストコードも修正が必要。
- **議論内容**: ウマオカ計算ロジックの現状確認と修正方針について議論。全員から返し点（`returnScore`）を減算し、1位に20000を加算する方式に変更する方針で決定。データモデルに`finalScoreWithUmaOka`フィールドを追加し、ウマオカ考慮後の値を保存する方針で決定。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 ウマオカ計算ロジックの修正と統計情報の改善)

### 2026-01-01 統計情報にウマオカを考慮した合計点数を表示する

### [議論完了] 統計情報にウマオカを考慮した合計点数を表示する

- **内容**: 統計情報APIにウマオカを考慮した合計点数を表示する。複数半荘に参加した場合、各半荘の`finalScoreWithUmaOka`（ウマオカ考慮済みの最終得点）の合計を表示する。また、平均最終得点（`averageScore`）と流局回数（`totalDraws`）は削除する。対象API: `GET /api/players/:id/statistics`（参加者統計）、`GET /api/sessions/:id/statistics`（セッション統計）。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 統計情報、参加者統計、セッション統計、`statisticsService.ts`、`getPlayerStatistics`関数、`getSessionStatistics`関数、`GET /api/players/:id/statistics` API、`GET /api/sessions/:id/statistics` API
- **備考**: データモデルに`finalScoreWithUmaOka`フィールドを追加し、ウマオカ考慮後の値を保存する。複数半荘の`finalScoreWithUmaOka`の合計を表示することで、ウマオカを考慮した合計点数を表示できる。フィールド名は`totalFinalScore`を想定。平均最終得点（`averageScore`）と流局回数（`totalDraws`）は削除する。既存データには反映しない。
- **議論内容**: データモデルの変更について議論。`finalScore`はウマオカ考慮前の値（`currentScore`）を保存し、`finalScoreWithUmaOka`はウマオカ考慮後の値を保存する方針で決定。統計情報で`finalScoreWithUmaOka`の合計を表示し、平均最終得点と流局回数を削除する方針で決定。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 ウマオカ計算ロジックの修正と統計情報の改善)

### 2026-01-01 半荘終了時にウマオカの計算結果を半荘の結果として保存する

### [議論待ち] 半荘終了時にウマオカの計算結果を半荘の結果として保存する

- **内容**: 半荘終了時にウマオカの計算結果を半荘の結果として保存するようにしたい。各メンバー順位と得点の両方が保存できるように。現在の実装では`finalScore`のみが保存されているが、順位（rank）は保存されていない。`umaOkaCalculationService.ts`の`calculateUmaOka`関数は`FinalScore`インターフェースに`rank`を含めて返しているが、`hanchanService.ts`の`update`関数では`finalScore`のみを`HanchanPlayer`モデルに保存している。順位も保存するためには、`HanchanPlayer`モデルに`rank`フィールドを追加するか、または`finalScores`をJSON形式で保存する方法が考えられる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 半荘管理、半荘終了処理、ウマオカ計算、順位計算、得点計算、`hanchanService.ts`、`umaOkaCalculationService.ts`、`HanchanPlayer`モデル、`FinalScore`インターフェース、`PUT /api/hanchans/:id` API
- **備考**: 現在の実装では、半荘終了時に`calculateUmaOka`関数で順位と最終得点を計算しているが、順位は保存されていない。順位を保存することで、半荘終了後の統計情報や履歴表示で順位を直接参照できるようになる。データモデルの変更（`HanchanPlayer`に`rank`フィールド追加）が必要になる可能性がある。

### 2026-01-01 最近のセッションをホーム画面に追加します

### [議論完了] 最近のセッションをホーム画面に追加します

- **内容**: ホーム画面に最近のセッションを表示する機能を追加する。ユーザーがホーム画面から最近のセッションにアクセスできるようにし、セッション一覧画面への遷移を容易にする。最近のセッションは日付順または更新日時順で表示し、セッション名、日付、参加者数、半荘数などの情報を表示する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: ホーム画面、セッション機能、セッション一覧、`HomeView.vue`、`sessionService.ts`、`GET /api/sessions` API
- **議論内容**: UI配置について議論し、「最近の半荘」の上に「最近のセッション」セクションを追加する方針で決定。表示件数、表示情報、クリック時の動作、セッションがない場合の表示、ソート順について議論し、既存の半荘表示と同様の形式で実装する方針で決定。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 最近のセッションをホーム画面に追加します)

- **内容**: ホーム画面に最近のセッションを表示する機能を追加する。ユーザーがホーム画面から最近のセッションにアクセスできるようにし、セッション一覧画面への遷移を容易にする。最近のセッションは日付順または更新日時順で表示し、セッション名、日付、参加者数、半荘数などの情報を表示する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: ホーム画面、セッション機能、セッション一覧、`HomeView.vue`、`sessionService.ts`、`GET /api/sessions` API

### 2026-01-01 流局時に本場が増える処理を追加したい

### [議論完了] 流局時に本場が増える処理を追加したい

- **内容**: 流局時に本場が増える処理を追加したい。現在の実装では、流局時の本場計算ロジックが存在するが、正しく動作していない可能性がある。麻雀のルールに基づき、流局時に親がテンパイしている場合は次局の本場が1増加する処理を実装する必要がある。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 本場計算、流局処理、局終了処理、`riichiHonbaCalculationService.ts`、`calculateNextHonba`関数、`roundService.ts`、`endRound`関数
- **備考**: 既存のアイデア「本場の計算ロジックを見直す」（2026-01-01）と関連があるが、今回は流局時の本場増加処理に焦点を当てている。設計ドキュメント（`design/score-calculation-logic.md`）では「親がテンパイしている場合、本場が1増加」と記載されているが、実装が正しく動作しているか確認が必要。通常の流局（荒牌流局）と特殊流局（四槓、四風、九種九牌）で親がテンパイしている場合の本場増加処理を確認・実装する。
- **議論内容**: 流局時の本場計算ロジックの実装状況を確認。親がテンパイしている場合の本場増加は実装済み。特殊流局で親がテンパイしている場合も本場が増加する（実装は正しい、設計ドキュメントを更新）。全員ノーテン流局時の本場増加について議論。麻雀のルールに基づき、全員ノーテン流局の場合も本場が増加する必要があることを確認。連荘と本場増加は別の概念であることを確認。連荘の場合は局番号が変わらず本場が+1、全員ノーテン流局の場合は局番号が+1（連荘ではない）だが本場が+1。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 流局時に本場が増える処理を追加したい)

### 2026-01-01 ロンの時の点数記録ロジックを見直したい

### [議論待ち] ロンの時の点数記録ロジックを見直したい

- **内容**: ロンの時の点数記録ロジックを見直したい。具体的には、ダブロン時に上家が和了者でない場合、和了者の中で最も近い席順の人が積み棒を獲得するようにする。例: 東家（Aさん）がリーチし、南家（Bさん）と西家（Cさん）がAさんからダブロンした場合、Bさんにだけリーチ棒分（積み棒）が加算されるようにする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: ロン処理、点数計算、打点記録、局終了処理、ダブロン対応、積み棒計算、`roundService.ts`、`endRound`関数、`findUpperSeatWinner`関数
- **備考**: 現在の実装では、`findUpperSeatWinner`関数が放銃者から見て最も近い上家が和了者でない場合、`null`を返し、積み棒が誰にも分配されない問題がある。修正内容: `findUpperSeatWinner`関数を修正し、上家が和了者でない場合、和了者の中で最も近い席順の人を返すようにする。テストケースを作成し、動作を確認する。

### 2026-01-01 点数計算ロジックを設計を含め集約したい

### [議論完了] 点数計算ロジックを設計を含め集約したい

- **内容**: 点数計算ロジックが複数の場所に分散しているため、設計を含めて集約したい。現在、点数計算ロジックは以下の場所に分散している: (1) 設計ドキュメント: `design/score-calculation-logic.md`、(2) バックエンドサービス: `backend/src/services/scoreCalculationService.ts`、(3) フロントエンドComposable: `frontend/src/composables/useScoreCalculation.ts`、(4) バックエンドサービス（局終了処理）: `backend/src/services/roundService.ts`の`endRound`関数内、(5) フロントエンドの結果入力: `frontend/src/composables/useResultInput.ts`。これらを集約し、一貫性と保守性を向上させる。設計ドキュメントと実装コードの整合性を保ち、点数計算ロジックを一箇所に集約することで、変更時の影響範囲を明確にし、テストしやすくする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 点数計算、打点計算、積み棒計算、本場計算、`useScoreCalculation.ts`、`roundService.ts`、`scoreCalculationService.ts`、`useResultInput.ts`、`design/score-calculation-logic.md`、局終了処理、結果入力
- **備考**: 点数計算ロジックの集約方法としては、以下の選択肢が考えられる: (1) バックエンドの`scoreCalculationService.ts`を中心に集約し、フロントエンドはAPI経由で使用する、(2) フロントエンドとバックエンドで共通のロジックを共有する（共有ライブラリやコード生成など）、(3) 設計ドキュメントと実装コードの整合性を保つための仕組みを導入する（自動テスト、ドキュメント生成など）。設計ドキュメント（`design/score-calculation-logic.md`）と実装コードの整合性を保つことも重要である。
- **議論内容**: 点数計算ロジックが複数の場所に分散している問題を確認。局の結果記録画面でDB登録前の数値を表示していることが原因でフロントエンドの計算ロジックが煩雑になっている問題を確認。確定前のプレビュー表示を削除することで、フロントエンドの計算ロジックを簡素化できることを確認。バックエンドの計算ロジックを単一のソース（`scoreCalculationService.ts`）に集約する方針で合意。決定事項: 確定前のプレビュー表示（積み棒・本場による点数変動、局収支）を削除、確定ボタン押下時にバックエンドAPIで計算・保存、確定後にDBから取得したデータを表示、フロントエンドの計算ロジックを削除または簡素化、バックエンドの計算ロジックを単一のソースとして使用。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 点数計算ロジックを設計を含め集約したい)

### 2026-01-01 ダブロンの時、積み棒や本場は放銃した人から最も席順が近い人だけが受け取るようにする

### [議論完了] ダブロンの時、積み棒や本場は放銃した人から最も席順が近い人だけが受け取るようにする

- **内容**: ダブロン（複数の人が同時にロン）の時、積み棒や本場の点数は放銃者から見て最も席順が近い（上家）の和了者だけが受け取るようにする。現在の実装では、ダブロン時に和了者全員に積み棒や本場の点数が分配されているが、麻雀のルールに基づき、放銃者から見て最も近い上家（`seatPosition = (放銃者のseatPosition + 3) % 4`）だけが積み棒と本場の点数を受け取るように修正する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 打点記録、積み棒計算、本場計算、ダブロン対応、ロン処理、点数計算、`roundService.ts`、`endRound`関数、`Score`モデル
- **備考**: 既存のアイデア「打点記録の表にハンとフを出すのをやめ、積み棒と本場の点数移動を載せる」（2026-01-01）の備考に「ダブロン対応は別タスクとして扱う」と記載されており、このアイデアはその別タスクとして扱う。現在の実装では、`roundService.ts`の`endRound`関数（943-948行目）で和了者全員に積み棒を分配しているが、ダブロン時は最も近い上家のみに分配するように修正する必要がある。本場の点数計算についても同様に、ダブロン時は最も近い上家のみが本場の点数を受け取るように修正する。席順の計算方法: `seatPosition`を使用（0=東、1=南、2=西、3=北）、上家の`seatPosition = (放銃者のseatPosition + 3) % 4`。
- **議論内容**: ダブロン時の積み棒と本場の分配ルールについて議論。現在の実装では和了者全員に分配されている問題を確認。麻雀のルールに基づき、放銃者から見て最も近い上家のみが受け取る必要があることを確認。トリロンも同様のルール。ツモは対象外。実装方針: `endRound`関数で`seatPosition`を取得し、ダブロン判定を行い、最も近い上家のみに積み棒と本場を分配する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 ダブロンの時、積み棒や本場は放銃した人から最も席順が近い人だけが受け取るようにする)

### 2026-01-01 局管理の局の結果を記録でツモ、ロンの点数入力が反映されない

### [議論待ち] 局管理の局の結果を記録でツモ、ロンの点数入力が反映されない

- **内容**: 局管理画面で局の結果を記録する際、ツモ・ロンの点数入力が反映されない問題がある。`ResultInputDialog.vue`で点数を入力しても、その値が`resultDialogData.value.scoreInputs`に反映されず、確定時に点数が保存されない。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: 局管理、局終了処理、結果入力、`RoundManageView.vue`、`ResultInputDialog.vue`、`useResultInput.ts`、点数入力
- **備考**: `useResultInput.ts`の`handleScoreChangeInput`関数が、`scoreInput`パラメータの変更を`resultDialogData.value.scoreInputs`の該当する要素に反映していないことが原因。修正内容: `handleScoreChangeInput`関数の最初に、`scoreInput`の変更を`resultDialogData.value.scoreInputs`の該当する要素に反映する処理を追加。また、ロンの場合、複数の和了者がいる場合にすべての和了者の点数の合計を放銃者からマイナスするように修正。

### 2026-01-01 セッション機能の追加

### [議論完了] セッション機能の追加

- **内容**: その日の参加者とその日の半荘をグルーピングするセッション機能を追加する。セッションは1日の麻雀セッションを表し、そのセッションに参加した参加者と、そのセッション中に行われた半荘を紐づける。これにより、1日のセッション単位で参加者や半荘を管理でき、セッションごとの統計情報や履歴を確認できるようになる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 半荘管理、参加者管理、統計情報、履歴管理
- **備考**: セッションには日付、参加者リスト、半荘リストが含まれる。セッション作成時に参加者を選択し、そのセッション中に作成される半荘は自動的にそのセッションに紐づく。セッションごとの統計情報（総局数、総時間、参加者ごとの成績など）を表示できるようにする。
- **議論内容**: セッション詳細画面から半荘作成を行う方針で決定。データモデル設計、画面構成、API設計について議論。既存の半荘一覧画面との関係、セッション詳細画面の半荘作成方法、セッションの日付管理、セッション削除時の動作について方針を決定。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 セッション機能の追加)

### 2026-01-01 git管理とCI/CDについて

### [議論完了] git管理とCI/CDについて

- **内容**: プロジェクトのgit管理とCI/CDパイプラインの設計・実装について検討する。具体的には以下の項目を検討する: (1) `.gitignore`の設定 - 不要なファイルやディレクトリを適切に除外する設定を確認・追加する、(2) ブランチ戦略 - メインブランチ、開発ブランチ、機能ブランチなどの運用方針を決定する、(3) コミットメッセージの規約 - コミットメッセージの形式やルールを統一する、(4) CI/CDパイプラインの構築 - 自動テスト、自動ビルド、自動デプロイなどのパイプラインを設計・実装する、(5) コードレビュープロセス - プルリクエストやマージのルールを定義する。これにより、開発フローの効率化とコード品質の向上を図る。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: プロジェクト管理、開発フロー、CI/CD、git管理、自動化
- **備考**: CI/CDまで含めて検討する。現在のプロジェクトにはCI/CDパイプラインが設定されていない可能性があるため、GitHub ActionsやGitLab CIなどのCI/CDツールを使用したパイプライン構築を検討する。また、既存の開発フロー（`prompts/00-ai-workflow.md`）との整合性も考慮する必要がある。
- **議論内容**: 全体方針から議論を開始。現状確認として、gitリポジトリが未初期化であること、`.gitignore`が`frontend/`と`backend/`に分かれていること、CI/CD設定が存在しないことを確認。推奨方針として以下を決定: (1) gitリポジトリの初期化を今すぐ行う、(2) ブランチ戦略はGitHub Flowを採用（mainブランチのみ、機能ブランチを作成してPRでマージ）、(3) コミットメッセージはConventional Commitsを採用、(4) CI/CDはGitHub Actionsを使用、(5) コードレビューはPRベースの開発を採用。ルートに`.gitignore`を作成し、frontend/backend共通の除外を定義する。CI/CDパイプラインは自動テスト（バックエンド・フロントエンド）と自動ビルドを含む。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 git管理とCI/CDについて)

### 2026-01-01 RoundManageView.vueのコンポーネント分割

### [議論完了] RoundManageView.vueのコンポーネント分割

- **内容**: `RoundManageView.vue`（現在1049行）を複数のコンポーネントに分割する。現在のファイルは非常に長く、複数の責務を持っているため、保守性と可読性の向上のためにコンポーネント分割が必要である。具体的には以下のコンポーネントに分割する: (1) `HanchanInfoCard.vue` - 半荘情報カード（半荘名、参加者表示）、(2) `HanchanDashboard.vue` - ダッシュボード（統計情報のテーブル表示）、(3) `RoundCard.vue` - 局カード（ExpansionPanel内の各局の表示、鳴き・リーチ記録、打点記録、アクションボタンを含む）、(4) `ActionList.vue` - 鳴き・リーチ記録のリスト表示、(5) `ScoreTable.vue` - 打点記録テーブル、(6) `RoundActionButtons.vue` - 局のアクションボタン（局を終了、次局へ、削除）、(7) `ActionAddDialog.vue` - アクション追加ダイアログ（鳴き・リーチ追加）、(8) `ResultInputDialog.vue` - 結果入力ダイアログ（局終了時の結果記録）。これらを`frontend/src/components/`ディレクトリに配置し、`RoundManageView.vue`から適切に呼び出すことで、コードの可読性と保守性を向上させる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、コード品質、保守性、`RoundManageView.vue`、コンポーネント設計、UI/UX、Vueコンポーネント分割
- **備考**: 既存のアイデア「RoundManageView.vueのコード整理」（2026-01-01）ではComposablesへの分離が完了しているが、コンポーネント分割は未対応。現在のファイルは1049行と非常に長く、テンプレート部分も複雑である。コンポーネント分割により、各コンポーネントの責務が明確になり、テストしやすくなり、再利用性も向上する。既存の`PlayerSelectButton.vue`コンポーネントのように、適切にpropsとemitsを定義し、親子間のデータフローを明確にする必要がある。分割時には、既存のComposables（`useRoundManagement`, `useRoundActions`, `useResultInput`など）を活用し、コンポーネント間でのロジックの重複を避ける。
- **議論内容**: 8つのコンポーネントへの分割方針で決定。各コンポーネントは単一責任の原則に従い、UI表示とユーザーインタラクションに集中する。ロジックは既存のComposablesに集約し、コンポーネントはprops/emitsで親子間のデータフローを明確にする。既存の`PlayerSelectButton.vue`のパターンを参考にし、一貫性のあるコンポーネント設計を目指す。段階的に実装し、各コンポーネントを順次作成・統合することで、既存の機能を壊さないように進める。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 RoundManageView.vueのコンポーネント分割)

### 2026-01-01 RoundManageView.vueのコメント整理とさらなるリファクタリング

### [議論完了] RoundManageView.vueのコメント整理とさらなるリファクタリング

- **内容**: `RoundManageView.vue`のコメント整理とさらなるリファクタリングを行う。現在のファイルには多数のコメントが存在し、以下の問題がある: (1) 不要なコメント - 「Composablesから取得済み」など、実装済みのことを示すコメントが多数存在し、コードの可読性を低下させている、(2) デバッグ用のコメントとconsole.log - デバッグ用のコメントやconsole.logが残っており、本番コードとして不要な情報が含まれている、(3) TODOコメント - 未対応のTODOコメントが存在し、対応が必要か確認が必要、(4) 重複した説明コメント - 同じ内容を説明するコメントが複数箇所に存在し、保守性が低下している、(5) コメントの統一性 - コメントの形式や言語（日本語/英語）が統一されていない。これらのコメントを整理し、必要なコメントのみを残すことで、コードの可読性と保守性を向上させる。また、コメント整理と合わせて、不要なラッパー関数の削除、重複コードの削減、関数名の改善など、さらなるリファクタリングも行う。**さらに、コンポーザブルへの切り出しの対応が済んでいない部分はさらに切り出す。**
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、コード品質、保守性、`RoundManageView.vue`、コメント整理、リファクタリング、コードリーディング、Composables
- **備考**: 既存のアイデア「RoundManageView.vueのコード整理」（2026-01-01）ではComposablesへの分離が完了しているが、コメントの整理は未対応。現在のファイルには121行以上のコメントが存在し、その多くが不要または改善が必要。特に「Composablesから取得済み」などのコメントは、実装が完了した後は不要である。デバッグ用のconsole.log（782行目など）も削除する必要がある。コメント整理と合わせて、不要なラッパー関数（例: `getRoundLabelWithDealerAndSticks`が`getRoundLabelForId`を単純にラップしているだけ）の削除や、重複コードの削減も検討する。**まだComposablesに切り出されていないロジック**: (1) `loadRoundData` - 局データ（鳴き・リーチ・打点記録）の読み込み、(2) `handleSaveRound` - 局の保存処理（非常に長い関数）、(3) `handleAddAction` / `handleDeleteAction` - アクション追加/削除処理、(4) `handleConfirmResult` - 結果確定処理、(5) `validateScoreInputsForRound` - スコア入力バリデーション、(6) `handleNextRoundFromPanel` - 次局への遷移処理、(7) ラッパー関数群（`getRiichiHonbaScoreChange`, `getTotalScoreChange`など）、(8) ダイアログ管理（`showActionDialog`, `showDeleteRoundDialog`など）、(9) ExpansionPanel管理（`expandedPanels`）。これらを適切なComposablesに切り出す。
- **議論内容**: コンポーザブルへの切り出しの対応が済んでいない部分はさらに切り出す方針で決定。以下のComposablesを作成または拡張する方針: (1) `useRoundData` - 局データ（鳴き・リーチ・打点記録）の読み込み処理、(2) `useRoundActions`の拡張 - アクション追加/削除処理を追加、(3) `useResultInput`の拡張 - 結果確定処理とスコア入力バリデーションを追加、(4) `useRoundNavigation` - 次局への遷移処理、(5) `useRoundDialogs` - ダイアログ管理（アクション追加、局削除確認など）、(6) `useRoundExpansion` - ExpansionPanelの展開状態管理、(7) `useRoundManagement`の拡張 - 局の保存処理を追加または統合。ラッパー関数は削除し、直接Composablesの関数を使用する。コメント整理は、Composablesへの切り出しと並行して実施する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 RoundManageView.vueのコメント整理とさらなるリファクタリング)

### 2026-01-01 RoundManageView.vueのコード整理

### [議論完了] RoundManageView.vueのコード整理

- **内容**: `RoundManageView.vue`のコードを整理する。現在のファイルは2352行と非常に長く、複数の責務を持っているため、保守性と可読性の向上のために整理が必要である。具体的には以下の整理を検討する: (1) コンポーネントの分割 - アクション追加ダイアログ、結果入力ダイアログ、局削除確認ダイアログ、ダッシュボード、局カードなどを個別のコンポーネントに分割する、(2) Composablesへのロジック分離 - 局管理ロジック（`useRoundManagement`）、スコア計算ロジック（`useScoreCalculation`）、アクション管理ロジック（`useRoundActions`）などをComposablesに分離する、(3) 重複コードの削減 - スコア入力の初期化処理、バリデーション処理、点数計算処理などの重複を削減する、(4) 型定義の整理 - インターフェースや型定義を適切な場所に移動する（`types/`ディレクトリまたはComposables内）、(5) 関数の整理 - 長い関数を分割し、責務を明確にする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、コード品質、保守性、`RoundManageView.vue`、コンポーネント設計、Composables、リファクタリング
- **備考**: 現在の実装では、`RoundManageView.vue`に以下の機能がすべて含まれている: 半荘情報表示、ダッシュボード表示、局一覧表示、アクション追加/削除、結果入力、局削除、次局作成など。これらを適切に分割することで、コードの可読性と保守性が向上する。既存の機能を壊さないように、段階的にリファクタリングを進める必要がある。テストコードも必要に応じて更新する。
- **議論内容**: まずComposablesの分離から行うことを決定。以下のComposablesを作成する方針: (1) `useRoundManagement` - 局の読み込み、作成、更新、削除、編集データ管理、バリデーション、(2) `useScoreCalculation` - 点数計算、積み棒・本場による点数変動計算、局収支計算、(3) `useRoundActions` - アクションの追加、削除、表示、(4) `useResultInput` - 結果入力ダイアログの管理、スコア入力の初期化、バリデーション、(5) `useRoundDisplay` - 局のラベル表示、風の表示、ソート。`frontend/src/composables/`ディレクトリを作成し、各Composableを実装する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 RoundManageView.vueのコード整理)

### 2026-01-01 局の結果を記録のUIを改善する

### [議論完了] 局の結果を記録のUIを改善する

- **内容**: 局の結果を記録するUIを改善する。現在の実装では、`RoundManageView.vue`の結果入力ダイアログ（254-382行目）で、結果タイプはv-chip-groupで選択し、スコア入力はv-card + v-checkbox + v-text-fieldで入力している。和了者・放銃者の選択をチェックボックスからチップ形式（v-chip-group）に変更し、テンパイ入力セクションと同様のUIパターンを適用することで、UIの一貫性と操作性を向上させる。また、点数入力のUI改善、入力の自動化、バリデーションの改善など、全体的なUI/UXの向上を図る。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局終了処理、スコア入力、UI/UX、`RoundManageView.vue`、結果入力ダイアログ、和了者選択、放銃者選択、点数入力
- **備考**: 既存のアイデア「スコア入力のユーザー選択をチップにする / ロンの時の複数和了者対応」（2026-01-01）と関連があるが、より広範囲なUI改善を想定している。現在の実装では、スコア入力セクションで各参加者をv-cardで表示し、チェックボックスで和了者・放銃者を選択しているが、これをテンパイ入力セクション（384-414行目）と同様にv-chip-groupを使用したチップ形式に変更する。また、点数入力のUI改善、入力の自動化、バリデーションの改善なども検討する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 局の結果を記録のUIを改善する)

### 2026-01-01 スコア入力のユーザー選択をチップにする / ロンの時の複数和了者対応

### [却下] スコア入力のユーザー選択をチップにする / ロンの時の複数和了者対応

- **内容**: スコア入力のユーザー選択をチップ（v-chip）形式に変更する。現在の実装では、`RoundManageView.vue`のスコア入力セクション（314-382行目）で各参加者をv-cardで表示し、チェックボックス（v-checkbox）で和了者・放銃者を選択しているが、これをテンパイ入力セクション（384-414行目）と同様にv-chip-groupを使用したチップ形式に変更する。また、ロンの時は複数の和了者がいる可能性があることを考慮する。ダブロン（2人同時ロン）やトリロン（3人同時ロン）を許容し、和了者の選択を複数選択可能にする。既存の`PlayerSelectButton.vue`コンポーネントを活用するか、同様のUIパターンを適用する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局終了処理、スコア入力、UI/UX、ダブロン対応、トリロン対応、`RoundManageView.vue`、`PlayerSelectButton.vue`、`resultDialogData.scoreInputs`、和了者選択、放銃者選択
- **備考**: 既存のアイデア「局終了時の記録方法の改善」（2025-01-01）ではダブロン・トリロンを許容することが決定されているが、UIの具体的な改善方法（チップ形式への変更）は今回のアイデアで提案している。現在の実装では、ロン時に和了者が1人であることをバリデーションしているが、ダブロン・トリロンを許容する必要がある。チップ形式に変更することで、視覚的に分かりやすく、操作性が向上する。テンパイ入力セクションと同様のUIパターンを適用することで、UIの一貫性も向上する。

### 2026-01-01 打点記録の点数変動について、和了者に点数を加算するロジックについて整理する

### [却下] 打点記録の点数変動について、和了者に点数を加算するロジックについて整理する

- **内容**: 打点記録の点数変動について、和了者に点数を加算するロジックについて整理する。現在の実装では、`roundService.ts`の`endRound`関数で、本場による点数変動（892-899行目）と積み棒による点数変動（943-948行目）で和了者に点数を加算しているが、ロジックが分散しており、整理が必要である。和了者への点数加算ロジックを統一し、一貫性を保つことで、コードの可読性と保守性を向上させる。本場による点数加算（和了者は`round.honba × 300`点を獲得）、積み棒による点数加算（和了者は`round.riichiSticks × 1000`点を獲得）、基本打点による点数加算（ツモ・ロン時の基本打点）を整理し、和了者への点数加算ロジックを明確にする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 打点記録、点数変動、和了処理、Scoreモデル、`roundService.ts`、`endRound`関数、本場計算、積み棒計算、基本打点計算、`RoundManageView.vue`
- **備考**: 現在の実装では、本場による点数変動と積み棒による点数変動が別々の処理で行われており、和了者への点数加算ロジックが分散している。和了者への点数加算を一箇所にまとめるか、または明確な順序で処理することで、ロジックを整理できる。また、ツモ・ロン時の基本打点による点数加算も含めて、和了者への点数加算ロジック全体を整理する必要がある。`design/score-calculation-logic.md`の打点計算ロジック設計書を参照し、和了者への点数加算ルールを確認する。

### 2026-01-01 リーチ記録と本場の点数算出を「局を終了」時に行うように統一したい

### [議論完了] リーチ記録と本場の点数算出を「局を終了」時に行うように統一したい

- **内容**: リーチ記録と本場の点数算出を「局を終了」時に行うように統一したい。現在の実装では、リーチ記録の追加/削除時に点数変動をリアルタイムで更新する方向で議論が進んでいるが、代わりに局終了時にリーチ記録と本場の点数算出をまとめて行うように統一することで、処理のタイミングを明確にし、ロジックを簡素化できる。局終了時にリーチ記録による点数変動（-1000点）と本場による点数変動を一括で計算し、打点記録として記録する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、リーチ記録、本場計算、点数算出、局終了処理、打点記録、`RoundManageView.vue`、`roundService.ts`、`endRound` API、`calculateRiichiSticksScoreChange`関数
- **備考**: 既存のアイデア「リーチ記録と点数変動の記録が連動していない」（2026-01-01）ではリアルタイム更新の方向で議論が完了しているが、今回は局終了時に統一するという異なるアプローチを提案している。局終了時にリーチ記録と本場の点数算出をまとめて行うことで、処理のタイミングが明確になり、局進行中の点数変動表示の複雑さを避けられる。局終了時には、リーチ記録による点数変動、本場による点数変動、和了・流局による点数変動を統合して計算し、打点記録として記録する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 リーチ記録と本場の点数算出を「局を終了」時に行うように統一したい)

### 2026-01-01 打点記録としてリーチ者の-1000が記録されるようにしたい

### [議論完了] 打点記録としてリーチ者の-1000が記録されるようにしたい

- **内容**: 打点記録として、リーチ者の-1000点が記録されるようにしたい。また、リーチに関する打点記録のロジックを整理したい。現在の実装では、リーチ宣言時の-1000点の支払いが打点記録（Score）として適切に記録されていない可能性がある。リーチ記録を追加した際に、リーチ者のScoreとして-1000点の打点記録が作成され、打点記録テーブルに表示されるようにする。また、リーチに関する打点記録の計算ロジック（`calculateRiichiSticksScoreChange`関数など）を整理し、一貫性を保つ。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 打点記録、リーチ記録、点数変動、Scoreモデル、`RoundManageView.vue`、`calculateRiichiSticksScoreChange`関数、`roundService.ts`、リーチ記録追加/削除API
- **備考**: 既存のアイデア「リーチ記録と点数変動の記録が連動していない」（2026-01-01）と関連があるが、今回は「打点記録として記録される」という点と「ロジックの整理」に焦点を当てている。リーチ記録追加時にScoreを作成し、リーチ者の-1000点を打点記録として記録する。リーチ記録削除時には対応するScoreを削除する。局終了時には、リーチ記録によるScoreと局終了時のScoreを統合する必要がある。リーチに関する打点記録の計算ロジックを整理し、一貫性を保つ。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 打点記録としてリーチ者の-1000が記録されるようにしたい)

### 2026-01-01 リーチ記録と点数変動の記録が連動していない

### [議論完了] リーチ記録と点数変動の記録が連動していない

- **内容**: リーチ記録を追加/削除したときに、点数変動の表示（打点記録テーブル）と点数変動の記録（データベースへの保存）がリアルタイムで更新されていない。現在の実装では、リーチ記録を追加/削除すると`riichiSticks`は更新されるが、点数変動の計算（`calculateRiichiSticksScoreChange`関数）で使用されるリーチ記録（`round.riichis`）と点数変動の表示（`roundScores`）が連動していない。特に、局が終了していない状態でリーチ記録を追加/削除した場合、点数変動の表示が更新されない。リーチ宣言時は-1000点の支払いが発生するため、リーチ記録の追加/削除に応じて点数変動の表示と記録の両方を自動的に更新されるべきである。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、リーチ記録、点数変動表示、点数変動記録、打点記録、`RoundManageView.vue`、`calculateRiichiSticksScoreChange`関数、`handleAddAction`関数、`handleDeleteAction`関数、`Score`モデル、`endRound` API
- **備考**: 現在の実装では、`handleAddAction`関数（1471-1480行目）と`handleDeleteAction`関数（1519-1528行目）でリーチ記録の追加/削除時に`riichiSticks`を更新しているが、点数変動の表示（`roundScores`）と点数変動の記録（Score）は更新されていない。`calculateRiichiSticksScoreChange`関数（716-739行目）は`round.riichis`を参照してリーチ宣言時の支払い（-1000点）を計算しているが、リーチ記録の追加/削除時に点数変動の表示がリアルタイムで再計算されていない。また、Scoreは局終了時（`endRound`）にのみ作成されるため、リーチ記録追加/削除時にScoreを作成/更新する機能が必要である。局が終了していない状態でも、リーチ記録の追加/削除に応じて点数変動の表示と記録の両方を更新する必要がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 リーチ記録と点数変動の記録が連動していない)

### 2026-01-01 本場の計算ロジックを見直す

### [議論完了] 本場の計算ロジックを見直す

- **内容**: 親が上がった、もしくはテンパイしたまま流局した場合の次の局の本場と局のロジックは共通になるべき。現在、親が上がった場合と親がテンパイしたまま流局した場合で、次の局の本場計算や連荘判定のロジックが分離されている可能性がある。これらは同じ条件（親が連荘する）で同じ処理（本場+1、連荘）を行うべきであるため、ロジックを共通化し、一貫性を保つ必要がある。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 本場計算、連荘判定、局管理、`riichiHonbaCalculationService.ts`、`roundService.ts`、`roundController.ts`、局終了処理、次局計算
- **備考**: 親が上がった場合（`isDealerWinner === true`）と親がテンパイしたまま流局した場合（`resultType === DRAW && isDealerTenpai === true`）は、どちらも連荘となり本場が+1される。この2つのケースで同じロジックを使用することで、コードの重複を減らし、保守性を向上させる。`calculateNextHonba`関数や`calculateIsRenchan`関数、局終了時の連荘判定ロジックを確認し、共通化できる箇所を特定する。特殊流局で親がテンパイした場合も連荘になり、本場も増える（現在の不整合を修正）。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 本場の計算ロジックを見直す)

### 2026-01-01 局開始時に連荘する（本場が加算される）ロジックを整理する

### [議論完了] 局開始時に連荘する（本場が加算される）ロジックを整理する

- **内容**: 局開始時に連荘する（本場が加算される）ロジックを整理する。現在、連荘と本場の計算ロジックは複数の場所に散らばっており、局開始時の連荘判定と本場の加算処理が明確でない可能性がある。`riichiHonbaCalculationService.ts`の`calculateNextHonba`関数と`calculateIsRenchan`関数、`roundService.ts`の`endRound`関数内の連荘判定、`roundController.ts`の`calculateNextSettings`関数など、関連するロジックを整理し、局開始時に連荘が正しく判定され、本場が適切に加算されるようにする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、連荘判定、本場計算、`riichiHonbaCalculationService.ts`、`roundService.ts`、`roundController.ts`、局開始処理、局終了処理
- **備考**: 連荘の判定条件は以下の通り: (1) 親が和了した場合（`isDealerWinner === true`）→ 連荘、本場+1、(2) テンパイ流局時に親がテンパイしていた場合（`resultType === DRAW && isDealerTenpai === true`）→ 連荘、本場+1。局開始時に前局の結果に基づいて連荘を判定し、本場を適切に設定するロジックを整理する必要がある。局作成時（`createRound`）と局更新時（`updateRound`）での連荘と本場の扱いを確認し、一貫性を保つ。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 局開始時に連荘する（本場が加算される）ロジックを整理する)

### 2026-01-01 打点記録の表にハンとフを出すのをやめ、積み棒と本場の点数移動を載せる

### [議論完了] 打点記録の表にハンとフを出すのをやめ、積み棒と本場の点数移動を載せる

- **内容**: 打点記録の表（`RoundManageView.vue`の137-153行目）で、現在表示されているハン（飜）とフ（符）のカラムを削除し、代わりに積み棒と本場の点数移動を表示する。現在の`scoreHeaders`（641-647行目）には「飜」と「符」のカラムが含まれているが、これらを削除し、「積み棒」と「本場」のカラムを追加する。積み棒による点数移動は和了者が獲得する点数（積み棒1本=1000点）、本場による点数移動は親子の判定と結果タイプ（ツモ・ロン）に応じて計算される点数（親がツモ: 子1人あたり本場×300点、子がツモ: 親から本場×300点・子から本場×100点、ロンも同様）を表示する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、打点記録、UI/UX、`RoundManageView.vue`、`scoreHeaders`、`roundScores`、積み棒計算、本場計算
- **備考**: 現在の実装では、`Score`型（`frontend/src/types/round.ts`の34-49行目）に`han`と`fu`が含まれているが、これらを表示から削除する。積み棒と本場の点数移動は、`round`オブジェクトから`honba`と`riichiSticks`を取得し、各参加者の`isWinner`、`isDealer`、`isRonTarget`などの情報を使って計算する必要がある。打点計算ロジック（`design/score-calculation-logic.md`）を参照して、積み棒と本場による点数移動を正確に計算する。ダブロン時のルール: ダブロン時は「放銃者から見て最も近い上家」だけが積み棒と本場の点数を受け取る（上家の`seatPosition = (放銃者のseatPosition + 3) % 4`）。ダブロン対応は別タスクとして扱う。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 打点記録の表にハンとフを出すのをやめ、積み棒と本場の点数移動を載せる)

### 2026-01-01 半荘情報にダッシュボード機能を設けたい

### [議論完了] 半荘情報にダッシュボード機能を設けたい

- **内容**: 半荘情報にダッシュボード機能を設けたい。どんな情報を出せるか整理するところからやりたい。現在、`RoundManageView.vue`には半荘情報を表示する部分があるが、シンプルな表示のみである。また、`GET /api/hanchans/:id/statistics`という統計情報取得APIが存在し、参加者ごとの和了回数、ツモ回数、ロン回数、放銃回数、流局回数、順位などの情報を取得できる。これらの情報を視覚的に分かりやすく表示するダッシュボード機能を追加することで、半荘の進行状況や各参加者のパフォーマンスを一目で把握できるようになる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 半荘管理、統計情報、ダッシュボード、UI/UX、`RoundManageView.vue`、`statisticsService.ts`、`GET /api/hanchans/:id/statistics` API
- **備考**: 既存の統計情報API（`getHanchanStatistics`）を活用し、ダッシュボードに表示する情報を整理する必要がある。表示可能な情報の例: 参加者ごとの現在の得点、順位、和了回数、ツモ回数、ロン回数、放銃回数、流局回数、和了率、放銃率、局数、進行状況（東場/南場）、本場、積み棒など。グラフやチャートを使用した視覚的な表示も検討する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 半荘情報にダッシュボード機能を設けたい)

### 2026-01-01 東4局の次が南5局になってしまう不具合に対応したい

### [議論完了] 東4局の次が南5局になってしまう不具合に対応したい

- **内容**: 東4局の次が南5局になってしまう不具合がある。正しくは東4局の次は南1局（局番号5、風は南）になるべきだが、何らかの理由で正しく計算されていない可能性がある。`calculateNextWind`関数と`calculateNextRoundNumber`関数の実装を確認し、東4局から南1局への遷移が正しく計算されるように修正する必要がある。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: 局管理、次局計算、風の切り替え、`calculateNextWind`関数、`calculateNextRoundNumber`関数、`calculateNextSettings` API、`handleNextRoundFromPanel`関数
- **備考**: 現在の実装では、`backend/src/services/riichiHonbaCalculationService.ts`の`calculateNextWind`関数（163-182行目）と`calculateNextRoundNumber`関数（145-155行目）で次局の風と局番号を計算している。東4局（currentRoundNumber=4）で連荘でない場合、nextRoundNumber=5となり、5は5-8の範囲なので"SOUTH"を返すようになっているが、実際の動作で不具合が発生している可能性がある。`roundController.ts`の`calculateNextSettings`関数（1066-1207行目）やフロントエンドの`handleNextRoundFromPanel`関数（1534-1633行目）での計算ロジックも確認する必要がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 東4局の次が南5局になってしまう不具合に対応したい)

### 2025-12-31 連荘のチェックボックスの削除

### [議論完了] 連荘のチェックボックスの削除

- **内容**: `RoundManageView.vue`の90-94行目にある連荘のチェックボックスが不要だと思うので削除したい。現在の実装では、局編集画面で連荘を手動でチェックできるようになっているが、連荘の判定は局終了時の結果（上がりが親であるか、テンパイ流局時に親がテンパイしていたかなど）から自動的に判定できるため、手動でのチェックは不要である。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局編集画面、連荘判定、UI/UX
- **備考**: 現在の実装では、`RoundManageView.vue`の90-94行目で連荘のチェックボックス（`v-checkbox`）が表示されている。連荘は局終了時の結果から自動的に判定できるため、手動でのチェックは不要である。チェックボックスを削除することで、UIがシンプルになり、誤った入力も防げる。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 連荘のチェックボックスの削除)

### 2025-12-31 局の結果記録の入力欄をよりコンパクトにしたい

### [議論完了] 局の結果記録の入力欄をよりコンパクトにしたい

- **内容**: 局の結果記録の入力欄をよりコンパクトにする。また、点数のデフォルト値を0にしたい。また、自摸上がりの時は上がった人以外の入力を自動にしたい。現在の実装では、局終了時の結果入力がv-selectとv-data-tableで行われているが、入力欄が大きく画面を占有している。よりコンパクトな表示にすることで、画面スペースを効率的に使用できるようになる。また、点数のデフォルト値を0にすることで、初期状態での入力が明確になる。自摸上がりの場合、上がった人以外の3人から点数をマイナスする必要があるが、現在は手動入力になっている可能性がある。上がった人の点数を入力すると、自動的に他の3人の点数が計算されるようにする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局終了処理、結果入力、UI/UX、自摸上がり処理、点数計算
- **備考**: 現在の実装では、`RoundManageView.vue`の局終了時の結果入力（v-selectとv-data-table）で点数を入力している。自摸上がりの場合、上がった人の点数を入力すると、自動的に他の3人の点数（親子の判定、本場、積み棒を考慮）を計算し、入力欄に自動入力する機能を実装する。入力欄のコンパクト化については、v-data-tableの表示方法を改善するか、よりコンパクトな入力方法（例: ダイアログ形式、カード形式など）を検討する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 局の結果記録の入力欄をよりコンパクトにしたい)

### 2025-12-31 積み棒の自動計算機能を付けたい

### [却下] 積み棒の自動計算機能を付けたい

- **内容**: 積み棒の自動計算機能を追加する。現在の実装では、積み棒を手動で入力する必要があるが、局の進行状況や流局時の状況に応じて積み棒を自動的に計算できるようにする。これにより、手動入力の手間を減らし、記録の正確性を向上させる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、積み棒計算、局終了処理、流局処理
- **備考**: 積み棒は通常、流局時に誰も和了しなかった場合に増える。親が流局した場合は連荘となり、積み棒が増える。積み棒の自動計算ロジックを実装し、局の終了状況に応じて自動的に積み棒を更新する機能を追加する。

### 2025-12-31 次局へボタンを押したときに局が追加されない不具合を修正したい

### [議論完了] 次局へボタンを押したときに局が追加されない不具合を修正したい

- **内容**: 「次局へ」ボタンを押したときに局が追加されない不具合を修正する。現在の実装では、`RoundManageView.vue`の`handleNextRoundFromPanel`関数（1493-1594行目）で次局のオブジェクトをローカルで作成して`rounds.value.push(nextRound)`で追加しているが、実際に`createRound` APIを呼び出してバックエンドに局を作成していない。そのため、次局がフロントエンド側のローカル状態にのみ存在し、データベースには保存されていない。ページをリロードすると次局が消えてしまう、または実際にデータベースに保存されていないという問題が発生している。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: 局管理、次局作成、`handleNextRoundFromPanel`関数、`createRound` API、`RoundManageView.vue`
- **備考**: `handleAddAction`関数内で局を作成している処理（1196-1217行目）を参考に、`createRound` APIを呼び出して実際に局を作成する必要がある。次局の設定（局番号、風、本場、積み棒、連荘、親）は`calculateNextSettings` APIで計算されているが、実際に局を作成する処理が抜けている。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 次局へボタンを押したときに局が追加されない不具合を修正したい)

### 2025-12-31 ラウンドの開始という概念とIN_PROGRESSのバリデーション両方がいらない

### [議論完了] ラウンドの開始という概念とIN_PROGRESSのバリデーション両方がいらない

- **内容**: ラウンドの開始という概念とIN_PROGRESSのバリデーション両方がいらない。現在の実装では、ラウンドにアクション（鳴き、リーチなど）を追加する際に、ラウンドが開始されている（`startedAt`が設定されている）必要があり、バリデーションで`IN_PROGRESS`状態であることを確認している。しかし、ラウンドの開始という概念自体が不要であり、IN_PROGRESSのバリデーションも不要である。ラウンドが作成された時点で、すぐにアクションを追加できるようにすべきである。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、ラウンド管理、バリデーション、アクション追加、鳴き記録、リーチ記録
- **備考**: 現在の実装では、`roundService.ts`の`createRoundAction`関数（411-413行目）で`!round.startedAt || round.endedAt`の条件でIN_PROGRESSのバリデーションを行っている。また、フロントエンドの`RoundManageView.vue`で、アクション追加前にラウンドを開始する処理を追加している。これらの開始概念とバリデーションを削除することで、ラウンド作成後すぐにアクションを追加できるようになり、操作性が向上する。`startedAt`フィールドは記録用として残す。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 ラウンドの開始という概念とIN_PROGRESSのバリデーション両方がいらない)

### 2025-12-31 鳴きの記録とリーチ記録を分ける必要があるか

### [議論完了] 鳴きの記録とリーチ記録を分ける必要があるか

- **内容**: 現在、鳴きの記録とリーチ記録を別々に管理しているが、これらを分ける必要があるか検討する。現在の実装では、UIレベルで別々のカード（`naki-card`と`riichi-card`）で表示し、APIレベルで別々のエンドポイント（`POST /api/rounds/:id/nakis`と`POST /api/rounds/:id/riichis`）を使用し、データモデルレベルで別々のテーブル（`Naki`と`Riichi`）として管理している。これらを統合するか、または分けたままにするかの判断が必要。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、鳴き記録、リーチ記録、データモデル設計、API設計、UI/UX
- **備考**: 現在の実装では、鳴きとリーチは異なる属性を持っている（鳴き: type, targetPlayerId, tiles / リーチ: isDoubleRiichi, isIppatsu, declaredAt）。これらを統合する場合、データモデルの変更、APIの変更、UIの変更が必要になる。分けたままにする場合のメリット・デメリット、統合する場合のメリット・デメリットを検討する必要がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 鳴きの記録とリーチ記録を分ける必要があるか)

### 2025-12-31 鳴きを追加で鳴きの種類や参加者などをボタンで選択できるようにします

### [議論完了] 鳴きを追加で鳴きの種類や参加者などをボタンで選択できるようにします

- **内容**: 鳴き追加ダイアログで、鳴きの種類（ポン、チー、大明槓、暗槓）や参加者、対象参加者などをボタンで選択できるようにする。現在の実装では、プルダウン（v-select）で選択しているが、ボタン形式に変更することで、視覚的に分かりやすく、操作性が向上する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、鳴き記録、UI/UX
- **備考**: 現在の実装では、`RoundManageView.vue`の鳴き追加ダイアログ（269-315行目）で`v-select`を使用している。ボタン形式（v-btnやv-chipなど）に変更することで、選択肢を視覚的に確認しながら選択できるようになる。タッチデバイスでの操作性も向上する可能性がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 鳴きを追加で鳴きの種類や参加者などをボタンで選択できるようにします)

### 2025-12-31 半荘作成時に東1局0本場の局を作成するようにします

### [議論完了] 半荘作成時に東1局0本場の局を作成するようにします

- **内容**: 半荘作成時に東1局0本場の局を作成するようにする。現在の実装では、半荘作成後に手動で局を作成する必要があるが、半荘作成時に自動的に東1局0本場の局を作成することで、初期セットアップの手間を減らし、操作性を向上させる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 半荘管理、局作成、局初期化、半荘作成処理
- **備考**: 半荘作成API（`POST /api/hanchans`）で半荘を作成する際に、自動的に東1局0本場の局を作成する処理を追加する。局番号は1、風は東、本場は0で初期化する。親の設定は半荘開始時の親設定機能と連携する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 半荘作成時に東1局0本場の局を作成するようにします)

### 2025-12-31 半荘開始時に親が誰から始まるか記録できるようにしたい

### [議論完了] 半荘開始時に親が誰から始まるか記録できるようにしたい

- **内容**: 半荘開始時に親が誰から始まるかを記録できるようにする。席順で入力するようにすべき。これにより、親が誰であるかの入力を人が行う必要がなくなる想定。現在の実装では、局開始時に親を手動で選択する必要があるが、半荘開始時に最初の親を席順で記録しておくことで、各局の親を自動的に計算できるようになる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 半荘管理、親の設定、席順管理、局管理、局開始処理
- **備考**: 半荘開始時に席順（1番目、2番目、3番目、4番目など）で最初の親を記録し、各局の親を自動計算する機能を実装する。これにより、局開始時の親選択が不要になり、操作性が向上する。席順の入力方法としては、プルダウンやラジオボタンなどが考えられる。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 半荘開始時に親が誰から始まるか記録できるようにしたい)

### 2025-12-31 局管理画面で初期状態だと鳴きの記録とリーチの記録ができない

### [議論完了] 局管理画面で初期状態だと鳴きの記録とリーチの記録ができない

- **内容**: 局管理画面（`RoundManageView.vue`）で初期状態（局開始時）だと鳴きの記録とリーチの記録ができない問題がある。局が開始されていない状態や、局の初期状態では、鳴き追加ボタンやリーチ追加ボタンが無効化されている、または表示されていない可能性がある。局が開始された後（`startedAt`が設定された後）にのみ鳴きやリーチの記録が可能になるように実装されているが、実際の使用シーンでは局開始と同時に鳴きやリーチの記録が必要になる場合がある。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、鳴き記録、リーチ記録、UI/UX、局開始処理
- **備考**: 現在の実装では、局の状態に応じて鳴きやリーチの記録が可能かどうかを判定している可能性がある。局開始前でも鳴きやリーチの記録ができるようにするか、または局開始処理を改善して、局開始と同時に鳴きやリーチの記録が可能になるようにする必要がある。`RoundManageView.vue`の鳴き追加ボタンやリーチ追加ボタンの表示条件や有効化条件を確認し、適切に修正する必要がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 局管理画面で初期状態だと鳴きの記録とリーチの記録ができない)

### 2025-12-31 複数人一括で登録する機能が欲しい

### [議論完了] 複数人一括で登録する機能が欲しい

- **内容**: 参加者（プレイヤー）を複数人一度に登録できる機能を追加する。現在の実装では、`PlayerFormView.vue`で1人ずつ登録する必要があるが、複数人の名前を一度に入力して一括登録できる機能を追加する。これにより、初期セットアップ時や複数の参加者を一度に追加する際の操作性が向上する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 参加者管理、プレイヤー登録、`PlayerFormView.vue`、`PlayerListView.vue`、`playerController.create`、`playerService.create`
- **備考**: 現在の実装では、`POST /api/players`で1人ずつ登録する形式になっている。複数人一括登録の実装方法としては、以下の選択肢が考えられる: (1) バックエンドに一括登録用のエンドポイント（例: `POST /api/players/bulk`）を追加し、複数の名前を配列で受け取って一括登録する方法、(2) フロントエンドで複数の名前を入力できるUIを追加し、ループで個別に登録APIを呼び出す方法。バックエンドの一括登録エンドポイントを追加する方が、トランザクション管理やエラーハンドリングの観点から推奨される。UIとしては、テキストエリアに改行区切りで名前を入力する形式や、動的に入力フィールドを追加できる形式などが考えられる。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 複数人一括で登録する機能が欲しい)

### 2025-12-31 局入力画面での結果入力方法の改善

### [議論完了] 局入力画面での結果入力方法の改善

- **内容**: 局入力画面での結果入力方法をもっと良い形にしたい。UIUXともに鳴きやリーチの記録に寄せたい。現在の実装では、局終了時にv-selectでresultTypeを選択し、ツモ・ロンの場合はv-data-tableでスコア入力を行っているが、鳴き記録やリーチ記録のようにダイアログ形式で記録するなど、より統一感のあるUIに改善する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局終了処理、結果入力、UI/UX、鳴き記録、リーチ記録
- **備考**: 現在の実装では、`RoundManageView.vue`の183-285行目で局終了時の結果入力をv-selectとv-data-tableで行っている。一方、鳴き記録（330-376行目）やリーチ記録（378-412行目）はダイアログ形式（v-dialog）で記録している。結果入力もダイアログ形式に統一することで、UIUXの一貫性が向上し、操作性が改善される可能性がある。結果タイプ（ツモ、ロン、流局、流し満貫、特殊流局）の選択と、ツモ・ロン時のスコア入力（和了者、放銃者、点数、飜、符）をダイアログ内で行う形式を検討する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 局入力画面での結果入力方法の改善)

### 2025-12-31 アイデア記録時の日付確認方法の改善

### [議論完了] アイデア記録時の日付確認方法の改善

- **内容**: アイデア記録時に日付を記録する際に、最新のアイデアの日付を参照するのではなく、必ずdateコマンドで現在の日付を確認してから記録するようにする。これにより、日付の誤記録を防ぎ、正確な日付でアイデアを記録できるようになる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: アイデア記録フロー、コマンドシステム、`/idea`コマンド
- **備考**: `/idea`コマンドの実装を改善し、アイデア記録時に必ずdateコマンドを実行して現在の日付を取得してから記録するようにする。最新のアイデアの日付を参照する方法では、日付が変更された場合や、複数のアイデアを同じ日に記録する場合に誤った日付が記録される可能性がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 アイデア記録時の日付確認方法の改善)

### 2025-12-31 鳴き記録とリーチ記録のUIをシンプルにする

### [議論完了] 鳴き記録とリーチ記録のUIをシンプルにする

- **内容**: 鳴き記録とリーチ記録の表示を、現在のテーブル表示（v-data-table）からよりシンプルな見た目に変更する。テーブル表示は画面を占有するエリアが広いため、よりコンパクトで視認性の高い表示方法に改善する。例えば、カード形式やリスト形式など、テーブルよりも画面スペースを効率的に使用できる表示方法を検討する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、鳴き記録、リーチ記録、UI/UX
- **備考**: 現在の実装では`RoundManageView.vue`の106-176行目で`v-data-table`を使用して鳴き記録とリーチ記録を表示している。テーブル表示は情報量が多い場合に有効だが、記録数が少ない場合でも画面を多く占有してしまう。よりシンプルでコンパクトな表示方法（例: v-chipやv-listを使用した表示）に変更することで、画面スペースを効率的に使用できるようになる。既存の「鳴きを追加」「リーチを追加」ボタンや削除機能は維持する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 鳴き記録とリーチ記録のUIをシンプルにする)

### 2025-01-02 鳴きとリーチの記録をflex表示にする

### [議論完了] 鳴きとリーチの記録をflex表示にする

- **内容**: 鳴き記録とリーチ記録の表示をflexレイアウトに変更する。モバイル表示時は縦に並べ、デスクトップ表示時は横に並べる。`@media`クエリを使用してレスポンシブ対応を実装する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、鳴き記録、リーチ記録、UI/UX、レスポンシブデザイン
- **備考**: `RoundManageView.vue`の鳴き記録とリーチ記録のセクションをflexレイアウトに変更し、モバイルとデスクトップで適切に表示されるようにする。実装方針: 2つのv-cardをflexコンテナで配置し、モバイル（600px以下）は縦並び、デスクトップ（600px以上）は横並びにする。既存のv-data-tableの表示は維持する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-01-02 鳴きとリーチの記録をflex表示にする)

### 2025-12-31 会話上の流れで行った変更を備考などにまとめる summarize コマンドの作成

### [議論完了] 会話上の流れで行った変更を備考などにまとめる summarize コマンドの作成

- **内容**: 会話上の流れで行った変更を備考などにまとめる summarize コマンドを作成する。開発中に会話を通じて行った変更や修正を、後から参照できるようにまとめる機能を提供する。変更内容、修正理由、影響範囲などを備考として記録し、ドキュメントやタスクに反映できるようにする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: コマンドシステム、ドキュメント管理、変更履歴管理
- **備考**: 会話履歴から変更内容を抽出し、構造化された形式でまとめる機能が必要。議事録やタスクの備考欄に自動的に反映する機能も検討する。
- **議論内容**: 会話上の流れで行った変更を備考などにまとめる機能の必要性について議論。会話履歴から変更内容を抽出し、構造化された形式でまとめる機能は有用であることを確認。既存の`/status`コマンドや`/continue`コマンドとの関係を整理し、`/summarize`コマンドとして実装する方針で決定。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2026-01-01 会話上の流れで行った変更を備考などにまとめる summarize コマンドの作成)

### 2025-01-01 直前の作業を再開する continue コマンドの作成

### [議論完了] 直前の作業を再開する continue コマンドの作成

- **内容**: 直前の作業が途中で止まってしまった場合に、それを再開する continue コマンドを作成する。`/status`コマンドは進捗状況を確認するコマンドだが、途中で止まった作業を自動的に再開する機能はない。`/continue`コマンドを追加することで、直前の作業（設計、実装、テスト、AIレビューなど）の続きから再開できるようにする。会話履歴や作業コンテキストを参照し、最後に実行していた作業を特定し、その続きから再開するフローを実装する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: コマンドシステム、ワークフロー管理、タスク管理
- **備考**: `/status`コマンドで問題を検出した後、`/continue`コマンドで自動的に再開できるようにすることで、作業の継続性が向上する。会話履歴から直前の作業を特定する方法や、作業コンテキストの保持方法について検討が必要。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-01-01 直前の作業を再開する continue コマンドの作成)

### 2025-01-01 局新規開始ボタンで局編集画面に入ると親が取得できない

### [議論完了] 局新規開始ボタンで局編集画面に入ると親が取得できない

- **内容**: 局新規開始ボタンで局編集画面に入ると親が取得できない問題がある。`RoundManageView.vue`の`setDefaultValues`関数で親を設定する処理があるが、局新規開始時に親が正しく取得・設定されていない可能性がある。`players.value`が空の状態で親を設定しようとしている、または`loadHanchan()`の完了を待たずに親を設定しようとしている可能性がある。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局編集画面、親の設定、デフォルト値の自動設定
- **備考**: 現在の実装では、`RoundManageView.vue`の`setDefaultValues`関数（637行目）で親を設定しているが、`onMounted`（1363行目）で`loadHanchan()`と`setDefaultValues()`を順番に呼んでいる。`setDefaultValues`内でも`loadHanchan()`を呼んでいるが、`players.value`が正しく設定される前に親を設定しようとしている可能性がある。親の取得タイミングと`players.value`の設定タイミングを確認し、適切な順序で処理が実行されるようにする必要がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-01-01 局新規開始ボタンで局編集画面に入ると親が取得できない)

### 2025-12-31 タブで局の管理をする

### [議論完了] タブで局の管理をする

- **内容**: 現在、`RoundManageView.vue`では「局開始」「局進行中」「局終了」の3つのタブで局の状態を管理しているが、この概念のタブ管理をやめて、タブで局の管理をする。具体的には、各局ごとにタブを作成し、タブで局を切り替えられるようにする。これにより、複数の局を一つの画面で管理でき、局間の移動が容易になる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、UI/UX、画面設計、タブ管理
- **備考**: 現在の実装では、`RoundManageView.vue`の22-26行目で`v-tabs`を使用して「局開始」「局進行中」「局終了」の3つのタブを管理している。これを各局ごとのタブに変更することで、局の切り替えが直感的になり、複数の局を同時に確認・編集できるようになる。ただし、タブの数が多くなる可能性があるため、タブの表示方法（スクロール可能なタブ、折りたたみ可能なタブなど）や、現在編集中の局の表示方法について検討が必要。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-31 タブで局の管理をする)

### 2025-01-01 次の局へボタンを押したときに局開始タブに遷移しない

### [議論完了] 次の局へボタンを押したときに局開始タブに遷移しない

- **内容**: 「次の局へ」ボタンを押したときに、次の局の入力画面に遷移するが、局開始タブ（「局開始」タブ）に自動的に遷移しない問題がある。現在の実装では、`handleNextRound`関数で`router.push`を使用して次の局の入力画面（`/hanchans/${hanchanId.value}/rounds/new?roundNumber=${nextRoundNumber}`）に遷移しているが、遷移後に`activeTab`が「局開始」タブ（`"start"`）に設定されていない可能性がある。次の局の入力画面に遷移した際に、自動的に「局開始」タブが選択されるようにする必要がある。また、連荘か連荘でないかで次の局の番号、風、本場が自動計算できるようにする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局終了処理、UI/UX、画面遷移
- **備考**: 現在の実装では、`RoundManageView.vue`の`handleNextRound`関数（1279行目）で次の局の入力画面へ遷移しているが、遷移後にタブが正しく設定されていない可能性がある。`activeTab`の初期値は`"start"`に設定されているが、何らかの理由で正しく動作していない可能性がある。遷移先の画面で`activeTab`が「局開始」タブに設定されることを確認し、必要に応じて修正する。また、連荘の判定は「上がりが親であるか」「テンパイ流局時に親がテンパイしていたか」で判定し、連荘か連荘でないかで次の局の番号、風、本場を自動計算する。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-01-01 次の局へボタンを押したときに局開始タブに遷移しない / 連荘判定による次の局の自動計算)

### 2025-12-31 鳴き記録とリーチ記録をチェックボックスでの選択に変更

### [却下] 鳴き記録とリーチ記録をチェックボックスでの選択に変更

- **内容**: 鳴き記録とリーチ記録の入力方法を、プルダウン（v-select）からチェックボックス（v-checkbox）での選択に変更する。現在、鳴き追加ダイアログでは参加者、鳴きタイプ、対象参加者をプルダウンで選択しているが、これをチェックボックスでの選択に変更する。リーチ追加ダイアログでは参加者をプルダウンで選択しているが、これもチェックボックスでの選択に変更する。これにより、複数の選択肢を一度に確認でき、操作性が向上する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、鳴き記録、リーチ記録、UI/UX
- **備考**: 現在の実装では、`RoundManageView.vue`の鳴き追加ダイアログ（269-315行目）とリーチ追加ダイアログ（318-351行目）で`v-select`を使用している。チェックボックスに変更することで、参加者や鳴きタイプを視覚的に確認しながら選択できるようになる。ただし、複数選択が可能になる場合のデータ構造やバリデーションルールの見直しが必要になる可能性がある。

### 2025-12-31 局終了時の半荘終了判定と次の局への遷移

### [却下] 局終了時の半荘終了判定と次の局への遷移

- **内容**: 局終了時に半荘終了であるかの判定を付けたい。半荘終了でない場合、次の局へ進むようにしたい。現在の実装では、局終了時に「次の局へ」ボタンで確認ダイアログを表示しているが、半荘終了の判定が行われていない。局番号が16局に達した場合、または誰かが30000点を超えた場合など、半荘終了の条件を判定し、半荘終了でない場合のみ次の局へ進むフローを実装する必要がある。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局終了処理、半荘管理、UI/UX
- **備考**: 半荘終了の判定条件を明確にする必要がある。一般的には、局番号が16局に達した場合、または誰かが30000点を超えた場合に半荘が終了する。局終了時に半荘終了判定を行い、半荘終了でない場合は自動的に次の局の入力画面へ遷移する機能を実装する。

### 2025-01-01 局終了時の記録方法の改善

### [議論完了] 局終了時の記録方法の改善

- **内容**: 局終了時にどのように終了したかの記録がイメージと異なる。現在の実装では、`resultType`（ツモ、ロン、流局、流し満貫、特殊流局）と`specialDrawType`（四槓、四風、九種九牌）で局の終了方法を記録しているが、ユーザーのイメージと異なる部分がある。具体的な差異を確認し、より直感的で使いやすい記録方法に改善する必要がある。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、局終了処理、UI/UX
- **備考**: 現在の実装では、局終了時に`resultType`と`specialDrawType`を選択し、ツモ・ロンの場合は打点記録を入力する形式になっている。ユーザーがイメージしている記録方法との差異を明確にし、改善案を検討する必要がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-01-01 局終了時の記録方法の改善)

### 2025-12-30 局にステータス必要ない

### [議論完了] 局にステータス必要ない

- **内容**: 局(Round)のステータス管理を削除する。現在RoundモデルにはRoundStatus enum (NOT_STARTED, IN_PROGRESS, COMPLETED)が定義されているが、これが不要である。局の状態は他のフィールド(startedAt, endedAt, resultTypeなど)から判断できるため、ステータスフィールドは冗長である。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: 局管理、データモデル、Roundモデル
- **備考**: ステータスを削除することで、データモデルがシンプルになり、状態管理の複雑さが減る。ビジネスロジックでの進行中チェックは不要であることを確認。状態判定はstartedAt/endedAtから計算する方針で決定。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-30 局にステータス必要ない)

### 2025-12-30 半荘と局登録のUIを実用に寄せる

### [議論完了] 半荘と局登録のUIを実用に寄せる

- **内容**: 半荘と局登録のUIを実用に寄せる。現在のUIをより使いやすく、実際の麻雀記録の流れに沿った操作性を向上させる。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: UI/UX、半荘登録、局登録
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-30 半荘と局登録のUIを実用に寄せる)

### 2025-12-30 デフォルトのデザインやcomponentを削除する

### [議論完了] デフォルトのデザインやcomponentを削除する

- **内容**: Vueプロジェクトの初期セットアップ時に生成されたデフォルトのデザインやコンポーネントを削除する。具体的には、`App.vue`のデフォルトデザイン（ロゴ、HelloWorldコンポーネント、デフォルトのナビゲーション）、`HelloWorld.vue`、`TheWelcome.vue`、`WelcomeItem.vue`、`icons/`ディレクトリ内のアイコンファイル、`HomeView.vue`と`AboutView.vue`のデフォルトコンテンツ、関連するテストファイル（`HelloWorld.spec.ts`など）を削除する。麻雀記録アプリに必要な独自のデザインとコンポーネントに置き換える。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: フロントエンド、UI/UX、コンポーネント設計
- **備考**: デフォルトのコンポーネントやデザインはプロジェクトの初期段階で役立つが、実際のアプリケーション開発では不要になる。削除することで、コードベースをクリーンに保ち、プロジェクトの目的に集中できる。削除前に、これらのコンポーネントが他の場所で使用されていないか確認する必要がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-30 デフォルトのデザインやcomponentを削除する)

### 2025-12-30 ReadMeを更新する

### [議論完了] ReadMeを更新する

- **内容**: プロジェクトのREADMEファイルを更新し、より詳細な情報を追加する。AI開発フロー（`/idea`, `/discuss`, `/design`, `/implement`, `/test`, `/review`などのコマンド）の説明、プロジェクトの開発フローやワークフローの明確化、より詳細な機能説明、コマンドシステムの説明などを追加する。現在のREADMEは基本的なセットアップ情報と技術スタックのみが記載されているが、AI開発フローやプロジェクトの運用方針についての情報が不足している。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: ドキュメント管理、プロジェクト管理
- **備考**: READMEはプロジェクトの入り口となる重要なドキュメントであり、新規参加者やAIがプロジェクトの全体像を理解するために必要な情報を含めるべき。AI開発フローやコマンドシステムの説明を追加することで、プロジェクトの運用方法が明確になる。

### 2025-12-30 Vueのslot記法の統一

### [議論完了] Vueのslot記法の統一

- **内容**: Vueのslotの記載方法について、lint対応を行う際に`#[`item.isRenchan`]`の文法を用いるようにする。動的なslot名を指定する場合に、この記法をプロジェクト全体で統一して使用する。現在、`RoundListView.vue`の54行目で`#[`item.isRenchan`]`の記法が使用されているが、他の箇所では静的な記法（`#item.status`など）が使用されている。動的なslot名が必要な場合は、`#[`item.xxx`]`の記法を統一して使用する方針とする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: Vueコンポーネント、lint設定、コーディング規約
- **備考**: この記法はVue 3の動的なslot名を指定するための標準的な記法であり、lintエラーを回避するために必要。プロジェクト全体で統一することで、コードの一貫性が保たれる。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-30 Vueのslot記法の統一)

### 2025-12-30 PostgreSQLへの移行

### [議論完了] PostgreSQLへの移行

- **内容**: 現在使用しているSQLiteからPostgreSQLに移行する。本番環境での運用や、将来的な拡張性を考慮して、より堅牢なデータベースシステムに移行する。Prismaスキーマの`provider`を`sqlite`から`postgresql`に変更し、接続URLの設定も更新する必要がある。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: データベース設定、Prisma設定、環境変数設定
- **備考**: 現在のプロジェクトはSQLiteを使用しているが、本番環境での運用や同時接続数の増加、より高度な機能（外部キー制約、トランザクションの堅牢性など）を考慮してPostgreSQLへの移行を検討する。移行時には既存データの移行手順も検討する必要がある。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-30 PostgreSQLへの移行)

### 2025-12-30 麻雀記録アプリの作成

### [議論完了] 麻雀記録アプリの作成

- **内容**: 麻雀の記録を行うためのアプリを作成する。参加者登録機能、局の記録機能、半荘の記録機能を実装する。局開始時には親の記録、本場の記録、連荘かどうか、積み棒の記録を行う。局中には鳴き（ポン、チー、大明槓、暗槓）の記録、リーチの記録を行う。局終了時にはツモの打点記録、ロンの打点記録、流し満貫、荒牌流局、特殊流局（四槓、四風、九種九牌）の記録を行う。半荘終了時には積み棒の移動、親の判定、流局時に親が聴牌しているかの判定、親が和了したかの判定、積み棒の算出、本場の算出を行う。打点計算では親子の判定、本場、積み棒を考慮し、和了した人にプラス、放銃した人（ロンの場合）または和了した人以外（ツモの場合）からマイナスする。
- **提案者**: ユーザー
- **優先度**: 高
- **関連機能**: 参加者管理、局記録、半荘記録、打点計算、積み棒計算、本場計算
- **備考**: 麻雀のルールに基づいた正確な記録と計算が必要。局の進行に応じた適切なタイミングでの記録が重要。新規プロジェクトとして開始し、データベースを使用、バックエンドをはじめから追加、リアルタイム重視で編集可能性も必要。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-30 麻雀記録アプリの作成)

### [議論完了] プロジェクトの運用方針を確認するコマンドの作成

- **内容**: このプロジェクトの運用方針について確認できるコマンドを作成する。プロジェクトの開発フロー、コーディング規約、ディレクトリ構造、テスト戦略、制約事項などの運用方針を確認できるコマンドを追加する。`prompts/`ディレクトリ内の各種ドキュメント（`00-ai-workflow.md`、`03-coding-standards.md`、`04-directory-structure.md`、`07-testing-strategy.md`、`10-constraints.md`など）を参照し、運用方針を確認できるようにする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: コマンドシステム、ドキュメント管理
- **備考**: 既存の`/status`コマンドはフローの進捗状況を確認するコマンドであり、運用方針を確認するコマンドとは異なる。プロジェクトの運用方針を素早く確認できるコマンドを追加することで、開発効率が向上する。コマンド名は`/policy`と決定し、カテゴリ選択式で表示する方針で決定した。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-26 プロジェクトの運用方針を確認するコマンドの作成)

### [議論完了] AI レビューフェーズを開始するコマンドの作成

- **内容**: AI レビューフェーズを開始するコマンドを作成する。`/test`コマンドでテストが完了したタスクに対して、AI レビューフェーズを開始するためのコマンドを追加する。`14-tasks.md`でテストフェーズが`[完了]`で AI レビューフェーズが`[未着手]`のタスクを確認し、AI レビューを開始するフローを明確にする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: コマンドシステム、タスク管理、AI レビューフロー
- **備考**: 既存のワークフロー（`00-ai-workflow.md`）では AI レビューフェーズが定義されているが、専用のコマンドが存在しない。`/test`コマンドと同様に、AI レビューフェーズを開始するためのコマンドを追加することで、フローをより明確にする。コマンド名は`/review`と決定し、レビュー内容を`15-review-guidelines.md`にドキュメント化することに決定した。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-26 AI レビューフェーズを開始するコマンドの作成)

### [議論完了] テストフェーズを開始するコマンドの作成

- **内容**: テストフェーズを開始するコマンドを作成する。`/implement`コマンドで実装が完了したタスクに対して、テストフェーズを開始するためのコマンドを追加する。`14-tasks.md`で実装フェーズが`[完了]`でテストフェーズが`[未着手]`のタスクを確認し、テストを開始するフローを明確にする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: コマンドシステム、タスク管理、テストフロー
- **備考**: 既存のワークフロー（`00-ai-workflow.md`）ではテストフェーズが定義されているが、専用のコマンドが存在しない。`/implement`コマンドと同様に、テストフェーズを開始するためのコマンドを追加することで、フローをより明確にする。また、テストコードの実装方針と実装タイミングについて議論し、TDD を推奨する方針で統一することに決定した。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-26 テストフェーズを開始するコマンドの作成)

### [議論完了] 議論から直接設計に入るフローをなくす

- **内容**: 現在の`/design`コマンドには議事録ベースの設計反映モードがあり、議論完了後に議事録が作成された時点で直接設計に進めるフローが存在する。これをなくし、必ず「タスク切り出し」を経てから設計に入るようにする。正しいフローは「議論 → 議事録記録 → タスク切り出し → 設計」であり、タスク切り出しをスキップして直接設計に入ることを防ぐ必要がある。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: コマンドシステム、タスク管理、設計フロー
- **備考**: `/design`コマンドのモード 1（議事録ベースの設計反映）を削除または無効化し、必ずタスク切り出しを経てから設計に入るようにする必要がある。これにより、フローの一貫性が保たれ、タスク管理が適切に行われるようになる。AI ドリブンな開発を目的としているため、AI の動作に一貫性を持たせることが非常に重要である。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-26 議論から直接設計に入るフローをなくす)

### [議論完了] 実装コマンドの作成

- **内容**: 実装フローを開始するコマンドを作成する。`/design`コマンドで設計が完了したタスクに対して、実装フェーズを開始するためのコマンドを追加する。`14-tasks.md`で設計フェーズが`[完了]`で実装フェーズが`[未着手]`のタスクを確認し、実装を開始するフローを明確にする。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: コマンドシステム、タスク管理、実装フロー
- **備考**: 既存のワークフロー（`00-ai-workflow.md`）では実装フェーズが定義されているが、専用のコマンドが存在しない。`/design`コマンドと同様に、実装フェーズを開始するためのコマンドを追加することで、フローをより明確にする。
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-25 実装コマンドの作成)

### [議論完了] 設計開始コマンドの改善・明確化

- **内容**: 設計開始のコマンドを作成または改善したい。既存の`design.md`コマンドは存在するが、タスクベースの設計開始フローをより明確にする必要がある。`/task`コマンドでタスクを選択した後、設計フェーズを開始する際のフローを改善する。
- **提案者**: ユーザー
- **優先度**: 中
- **関連機能**: コマンドシステム、タスク管理、設計フロー
- **備考**: 既存の`design.md`コマンドは主に議事録の反映に焦点を当てているが、タスクの設計フェーズを開始する際のフローをより明確に分離・改善する必要がある可能性がある
- **ステータス**: 議論完了 → 議事録に移行済み
- **議事録参照**: `11-meeting-notes.md` (2025-12-25 設計開始コマンドの改善・明確化)
