# コードレビューガイドライン

## 目的

このドキュメントは、AIレビューフェーズで実施するコードレビューのチェック項目とレビュー基準を定義します。`/review`コマンド実行時に参照されるレビュー内容を明確化します。

## レビューの対象

- 実装コード（フロントエンド・バックエンド）
- テストコード
- 設計ドキュメントとの整合性

## レビューの流れ

1. `14-tasks.md`でテストフェーズが`[完了]`でAIレビューフェーズが`[未着手]`のタスクを確認
2. タスクのAIレビューフェーズを`[進行中]`に更新
3. 以下のチェック項目に従ってレビューを実施
4. 改善点があれば指摘
5. レビュー完了後、タスクのAIレビューフェーズを`[完了]`に更新
6. レビュー完了日を記録

## チェック項目

### 1. 実装コードのレビュー

#### 1.1 コーディング規約の遵守確認

参照ドキュメント: `03-coding-standards.md`

##### TypeScript設定
- [ ] `tsconfig.json`で`strict: true`が設定されているか
- [ ] すべての関数、変数に型が明示されているか
- [ ] `any`型の使用が可能な限り避けられているか

##### 命名規則
- [ ] インターフェース・型: PascalCaseを使用しているか
- [ ] 関数・変数: camelCaseを使用しているか
- [ ] 定数: UPPER_SNAKE_CASEを使用しているか
- [ ] コンポーネント名: PascalCaseを使用し、ファイル名と一致しているか

##### インポート順序
- [ ] Vueからのimportが省略されていないか（`10-constraints.md`参照）
- [ ] インポート順序が正しいか（Vue → 外部ライブラリ → 内部モジュール → 型定義）
- [ ] 型定義のimportで`type`キーワードが使用されているか

##### コメント規約
- [ ] すべてのコメントが日本語で記述されているか
- [ ] 複雑なロジックに説明が追加されているか
- [ ] JSDoc形式が使用されているか（関数の場合）

##### 記号使用ルール
- [ ] 全角記号が使用されていないか（`10-constraints.md`参照）
- [ ] すべて半角記号（括弧`()`、カンマ`,`、ピリオド`.`など）が使用されているか

##### エラーハンドリング
- [ ] 非同期処理にtry-catch-finallyが使用されているか
- [ ] エラーメッセージがユーザーに分かりやすい日本語で記述されているか
- [ ] 開発者向けの詳細情報がconsoleに出力されているか

##### ファイル構造
- [ ] import文がファイルの先頭に記述されているか

#### 1.2 コードパターンの遵守確認

参照ドキュメント: `05-code-patterns.md`

##### Vue 3 Composition APIパターン
- [ ] `<script setup lang="ts">`構文が使用されているか
- [ ] `ref`と`computed`が適切に使用されているか
- [ ] ライフサイクルフックが適切に使用されているか

##### Composablesの設計
- [ ] 単一責任の原則が守られているか
- [ ] ビジネスロジックがComposablesに集約されているか
- [ ] コンポーネント間での状態共有が適切に行われているか

##### ユーティリティ関数
- [ ] 純粋関数として実装されているか
- [ ] 副作用がないか

##### 型安全性
- [ ] すべての関数に型が明示されているか

#### 1.3 制約事項の確認

参照ドキュメント: `10-constraints.md`

- [ ] 全角記号が使用されていないか
- [ ] コードの重複がないか（既存ロジックの確認）
- [ ] Vueからのimportが省略されていないか

#### 1.4 開発フローの遵守確認

参照ドキュメント: `08-development-workflow.md`

- [ ] 既存ロジックが確認され、重複が回避されているか
- [ ] lintエラーが修正されているか
- [ ] 影響範囲が特定されているか（修正時）

### 2. テストコードのレビュー

参照ドキュメント: `07-testing-strategy.md`

#### 2.1 テストコードの実装タイミング
- [ ] 実装フェーズでTDDによりテストコードが先に作成されているか（バックエンド）
- [ ] テストコードと実装コードが同時に、または実装コードの前に作成されているか

#### 2.2 テストカバレッジ
- [ ] すべての機能にテストが作成されているか（バックエンド必須）
- [ ] 正常系のテストが作成されているか
- [ ] 異常系のテストが作成されているか
- [ ] エッジケースのテストが作成されているか

#### 2.3 テストの品質
- [ ] テストが独立しているか（他のテストに依存していないか）
- [ ] テスト名が明確で、何をテストしているかが分かるか
- [ ] アサーションが明確で、期待値が明確に指定されているか

#### 2.4 テストの実行
- [ ] すべてのテストが通ることを確認
- [ ] テストカバレッジが確認されているか

### 3. 設計ドキュメントとの整合性確認

#### 3.1 設計ドキュメントとの整合性
- [ ] 設計ドキュメント（`design/`ディレクトリ）の内容と実装が一致しているか
- [ ] API仕様（`13-api-specifications.md`）と実装が一致しているか
- [ ] 画面設計と実装が一致しているか

#### 3.2 型定義との整合性
参照ドキュメント: `06-type-definitions.md`

- [ ] 型定義が適切に使用されているか
- [ ] 型定義と実装が一致しているか

#### 3.3 アーキテクチャとの整合性
参照ドキュメント: `02-architecture.md`

- [ ] アーキテクチャの設計方針に従っているか
- [ ] ディレクトリ構造が適切か（`04-directory-structure.md`参照）

### 4. 改善点の指摘

#### 4.1 パフォーマンス
- [ ] パフォーマンス改善の余地がないか
- [ ] 不要な再レンダリングが発生していないか
- [ ] メモリリークの可能性がないか

#### 4.2 可読性
- [ ] コードが読みやすいか
- [ ] 変数名・関数名が適切か
- [ ] コメントが適切に記述されているか

#### 4.3 保守性
- [ ] コードの重複がないか
- [ ] 関数が適切に分割されているか
- [ ] テストが適切に作成されているか

#### 4.4 セキュリティ
- [ ] セキュリティ上の懸念がないか
- [ ] 入力値の検証が適切に行われているか
- [ ] エラーハンドリングが適切か

## レビュー結果の記録

レビュー完了後、以下の情報を記録します:

- レビュー実施日
- レビュー対象のタスクID
- 指摘した改善点（あれば）
- レビュー完了日

## 関連ドキュメント

- `00-ai-workflow.md`: AI開発フローの全体像
- `03-coding-standards.md`: コーディング規約
- `05-code-patterns.md`: コードパターン
- `07-testing-strategy.md`: テスト戦略
- `08-development-workflow.md`: 開発フロー
- `10-constraints.md`: 制約事項
- `.cursor/commands/review.md`: `/review`コマンドの詳細

